<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="simian.xsl" type="text/xsl"?>
<!--
Similarity Analyser 2.2.24 - http://www.redhillconsulting.com.au/products/simian/index.html
Copyright (c) 2003-08 RedHill Consulting Pty. Ltd.  All rights reserved.
Simian is not free unless used solely for non-commercial or evaluation purposes.
-->
<simian version="2.2.24">
    <check ignoreCharacterCase="true" ignoreCurlyBraces="true" ignoreIdentifierCase="true" ignoreModifiers="true" ignoreStringCase="true" reportDuplicateText="true" threshold="6">
        <set lineCount="6">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="225" endLineNumber="230"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="37" endLineNumber="42"/>
            <text>
                <![CDATA[
            Try                oXmlRequest.LoadXml(xmlRequest)
                oFCDataXmlNode = oXmlRequest.SelectSingleNode("docrefchangereq/hdractivity")
                oFCDataXmlNode.InnerXml = _Function.ToString()
            Catch ex
                ExceptionManager.Publish(ex)
                ]]>
            </text>
        </set>
        <set lineCount="6">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="1833" endLineNumber="1840"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="1807" endLineNumber="1814"/>
            <text>
                <![CDATA[
            _ExcptInd = True            ' QC Defect ID:733  Modified By: MKANNAN3 Modified Date: 09/25/2009
            lblErrorMessage.Style.Add("display", "inline")
            lblErrorMessage.Text = "Unable to format Host request.  Please try again then call FOSS if unsuccesful"

            Return String.Empty
            Exit Function
        End Try
                ]]>
            </text>
        </set>
        <set lineCount="6">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\WCDocOpen.aspx.vb" startLineNumber="215" endLineNumber="221"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\ViewUpdate.aspx.vb" startLineNumber="251" endLineNumber="257"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\Resend.aspx.vb" startLineNumber="935" endLineNumber="941"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\RecipList.aspx.vb" startLineNumber="295" endLineNumber="301"/>
            <text>
                <![CDATA[
        objRoot.AppendChild(element)        element.AppendChild(elementTxt)

        element = objDom.CreateElement("formid")
        elementTxt = objDom.CreateTextNode(formid)
        objRoot.AppendChild(element)
        element.AppendChild(elementTxt)
                ]]>
            </text>
        </set>
        <set lineCount="6">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\ViewUpdate.aspx.vb" startLineNumber="659" endLineNumber="664"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5540" endLineNumber="5545"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5526" endLineNumber="5531"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5512" endLineNumber="5517"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\Resend.aspx.vb" startLineNumber="271" endLineNumber="276"/>
            <text>
                <![CDATA[
        For Each node As XmlNode In nodelist            If node.Attributes.GetNamedItem("value").Value = code.ToUpper Then
                Return node.InnerText.ToString
            End If
        Next
        Return code
                ]]>
            </text>
        </set>
        <set lineCount="6">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\TravelersFileCabinet.asmx.vb" startLineNumber="13" endLineNumber="30"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\Global.asax.vb" startLineNumber="14" endLineNumber="31"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\Global.asax.vb" startLineNumber="12" endLineNumber="29"/>
            <text>
                <![CDATA[
    Public Sub New()        MyBase.New()

        'This call is required by the Component Designer.
        InitializeComponent()

        'Add any initialization after the InitializeComponent() call

    End Sub

    'Required by the Component Designer
    Private components As System.ComponentModel.IContainer

    'NOTE: The following procedure is required by the Component Designer
    'It can be modified using the Component Designer.
    'Do not modify it using the code editor.
    <System.Diagnostics.DebuggerStepThrough()> Private Sub InitializeComponent()
        components = New System.ComponentModel.Container()
                ]]>
            </text>
        </set>
        <set lineCount="6">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="2017" endLineNumber="2023"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="1876" endLineNumber="1882"/>
            <text>
                <![CDATA[
                Dim errorText As String = ""                Dim ErrOccurred As Boolean = ErrCheck(xmlFcabReq, errorText)
                If ErrOccurred Then
                    ' QC Defect ID:733  Modified By: MKANNAN3 Modified Date: 09/25/2009
                    lblErrorMessage.Style.Add("display", "inline")
                    lblErrorMessage.Text = errorText.ToString()
                    _ExcptInd = True
                ]]>
            </text>
        </set>
        <set lineCount="6">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="3323" endLineNumber="3328"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="3170" endLineNumber="3175"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="307" endLineNumber="312"/>
            <text>
                <![CDATA[
            If stFcabReturn.Length > 0 Then                Dim objDom As New XmlDocument
                objDom.LoadXml(stFcabReturn)
                xmlEvalList = objDom.SelectNodes("//FileCabSave")
                If xmlEvalList.Count > 0 Then
                    Dim saveNode As XmlNode = xmlEvalList.Item(0)
                ]]>
            </text>
        </set>
        <set lineCount="6">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="1264" endLineNumber="1272"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="462" endLineNumber="470"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="379" endLineNumber="387"/>
            <text>
                <![CDATA[
                Return stRetRecs            End Try

            _Function = SearchForFcabRecs.ToString()
            Dim reqXMLNode As XmlNode

            reqXMLNode = xmlInput.SelectSingleNode("request/hdractivity")

            If reqXMLNode Is Nothing Then
                ]]>
            </text>
        </set>
        <set lineCount="6">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\ViewUpdate.aspx.vb" startLineNumber="771" endLineNumber="776"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\ViewUpdate.aspx.vb" startLineNumber="671" endLineNumber="676"/>
            <text>
                <![CDATA[
        For Each node As XmlNode In nodelist            If node.Attributes.GetNamedItem("value").Value = code.ToUpper Then
                Return node.InnerText.ToString
            End If
        Next
        Return String.Empty   'no match in xml then return empty string
                ]]>
            </text>
        </set>
        <set lineCount="6">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5009" endLineNumber="5015"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="1558" endLineNumber="1564"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="836" endLineNumber="842"/>
            <text>
                <![CDATA[
                Exit Sub            End Try

        End If
        If _ExcptInd Then
            Exit Sub
        End If
                ]]>
            </text>
        </set>
        <set lineCount="6">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="1133" endLineNumber="1139"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="1021" endLineNumber="1027"/>
            <text>
                <![CDATA[
                Dim strErr As String = Nothing                Dim cohostLayout As New XmlDocument
                Dim drvLtr As String = appSettings("Drive")
                Dim stLayoutPath As String = appSettings("Host_Record")

                cohostLayout.Load(drvLtr.ToString() & stLayoutPath.ToString())
                Dim rec1 As coHostRecordHelper.coHostRecord
                ]]>
            </text>
        </set>
        <set lineCount="6">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5071" endLineNumber="5076"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5028" endLineNumber="5034"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="1507" endLineNumber="1512"/>
            <text>
                <![CDATA[
        setSaveScreenValues("N")        loadDdlInOutList()
        Dim ws As WebState = New WebState
        Dim stFcSave As String = "FCSAVE"
        Dim stFcabSave As String = ws.GetState("FILECABSAVE", stFcSave.ToString())
        stFcabSave = stFcabSave.Trim()
                ]]>
            </text>
        </set>
        <set lineCount="6">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="564" endLineNumber="576"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="486" endLineNumber="491"/>
            <text>
                <![CDATA[
            Dim retVal As Long            Dim strErr As String = Nothing
            Try
                Dim mq As MQ.IMQHelper
                mq = New Travelers.Claim.Data.MQ.MQHelper()
                Dim req(0) As String
                ]]>
            </text>
        </set>
        <set lineCount="6">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\RecipList.aspx.vb" startLineNumber="27" endLineNumber="41"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\PhotowebPicopen.aspx.vb" startLineNumber="25" endLineNumber="38"/>
            <text>
                <![CDATA[
    Private designerPlaceholderDeclaration As System.Object
    Private Sub Page_Init(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Init
        'CODEGEN: This method call is required by the Web Form Designer
        'Do not modify it using the code editor.
        InitializeComponent()
    End Sub

#End Region
    Private Sub Page_PreInit(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.PreInit
        Me.DisablePortalMenus = True
    End Sub

    Private Sub Page_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
                ]]>
            </text>
        </set>
        <set lineCount="6">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="1169" endLineNumber="1176"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="1045" endLineNumber="1052"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="147" endLineNumber="155"/>
            <text>
                <![CDATA[
            Catch ex                ExceptionManager.Publish(ex)
                'Throw New BaseApplicationException(ex.ToString & " : " & "Base exception from FileCabinet DataObject PhotowebChangeReq")
                'stRetRecs = stRetRecs + GetComputerInfo()
                stRet = stRet + CreateErrorXML(1, ex.ToString())
                Return stRet
            End Try

            Return stRet
                ]]>
            </text>
        </set>
        <set lineCount="6">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="1114" endLineNumber="1120"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="938" endLineNumber="944"/>
            <text>
                <![CDATA[
        Dim objXMLDoc As New XmlDocument
        Try
            objXMLDoc.Load(strXMLSubFolderPath)
        Catch objError As Exception
            _ExcptInd = True
            Dim uiHelper As New Travelers.Claim.PortalBase.UI.Helper
                ]]>
            </text>
        </set>
        <set lineCount="6">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="585" endLineNumber="590"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="573" endLineNumber="578"/>
            <text>
                <![CDATA[
            If intRecipIdx > ddlRecipName.Items.Count Then                ddlSenderName.SelectedIndex = -1
                ddlTitle.SelectedIndex = -1
                ddlRecipName.SelectedIndex = -1
                ddlSource.SelectedIndex = -1
            Else
                ]]>
            </text>
        </set>
        <set lineCount="6">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\WCDocOpen.aspx.vb" startLineNumber="230" endLineNumber="236"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\ViewUpdate.aspx.vb" startLineNumber="256" endLineNumber="262"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\RecipList.aspx.vb" startLineNumber="300" endLineNumber="306"/>
            <text>
                <![CDATA[
        objRoot.AppendChild(element)        element.AppendChild(elementTxt)

        element = objDom.CreateElement("datetimestamp")
        elementTxt = objDom.CreateTextNode(datetimestamp)
        objRoot.AppendChild(element)
        element.AppendChild(elementTxt)
                ]]>
            </text>
        </set>
        <set lineCount="6">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\WCDocOpen.aspx.vb" startLineNumber="198" endLineNumber="203"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="2032" endLineNumber="2041"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\Resend.aspx.vb" startLineNumber="913" endLineNumber="918"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\RecipList.aspx.vb" startLineNumber="222" endLineNumber="227"/>
            <text>
                <![CDATA[
    Private Function addReqRecordFields() As String        Dim stRetrun As String = ""
        Dim objRoot As XmlElement
        Dim objDom As New XmlDocument
        Dim element As XmlElement
        Dim elementTxt As XmlText
                ]]>
            </text>
        </set>
        <set lineCount="6">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="3713" endLineNumber="3719"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="3484" endLineNumber="3490"/>
            <text>
                <![CDATA[
        Try            _dsDataGrid.ReadXml(Xreader)
        Catch ex
            _ExcptInd = True
            ' QC Defect ID:733  Modified By: MKANNAN3 Modified Date: 09/25/2009
            lblErrorMessage.Style.Add("display", "inline")
            lblErrorMessage.Text = "Unable to display host records.  Please retry and if unsucessful contact FOSS"
                ]]>
            </text>
        </set>
        <set lineCount="6">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\ViewUpdate.aspx.vb" startLineNumber="464" endLineNumber="469"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5100" endLineNumber="5105"/>
            <text>
                <![CDATA[
        stUserId = Page.User.Identity.Name.Substring(Page.User.Identity.Name.IndexOf("\") + 1)        stUserId = wp.Identity.Name.Split(CType("\", Char))(1).ToUpper
        If Not stUserId = "" Then
            stUserId = stUserId.ToUpper()
        Else
            stUserId = ""
                ]]>
            </text>
        </set>
        <set lineCount="6">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="2121" endLineNumber="2134"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\RecipList.aspx.vb" startLineNumber="270" endLineNumber="276"/>
            <text>
                <![CDATA[
        objRoot.AppendChild(element)        element.AppendChild(elementTxt)

        element = objDom.CreateElement("folder")
        elementTxt = objDom.CreateTextNode("ALL")
        objRoot.AppendChild(element)
        element.AppendChild(elementTxt)
                ]]>
            </text>
        </set>
        <set lineCount="6">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="1713" endLineNumber="1720"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="1693" endLineNumber="1700"/>
            <text>
                <![CDATA[
                _ExcptInd = True                ' QC Defect ID:733  Modified By: MKANNAN3 Modified Date: 09/25/2009
                lblErrorMessage.Style.Add("display", "inline")
                lblErrorMessage.Text = "Unable to complete request for counts. " & " Please retry and if unsucessful contact FOSS & ex.ToString() "

                Return String.Empty
                Exit Function
            End Try
                ]]>
            </text>
        </set>
        <set lineCount="6">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="1960" endLineNumber="1967"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="1925" endLineNumber="1931"/>
            <text>
                <![CDATA[
            _ExcptInd = True            ' QC Defect ID:733  Modified By: MKANNAN3 Modified Date: 09/25/2009
            lblErrorMessage.Style.Add("display", "inline")
            lblErrorMessage.Text = "Unable to complete request.  Please try again then call FOSS if unsuccesful"
            Return String.Empty
            Exit Function
        End Try
                ]]>
            </text>
        </set>
        <set lineCount="6">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="2295" endLineNumber="2301"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="2276" endLineNumber="2282"/>
            <text>
                <![CDATA[
        Catch transEx As Exception            _ExcptInd = True
            ' QC Defect ID:733  Modified By: MKANNAN3 Modified Date: 09/25/2009
            lblErrorMessage.Style.Add("display", "inline")
            lblErrorMessage.Text = "Unable to complete request.  Please retry and if unsucessful contact FOSS"
            Return String.Empty
            Exit Function
                ]]>
            </text>
        </set>
        <set lineCount="6">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\WCDocOpen.aspx.vb" startLineNumber="220" endLineNumber="226"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\ViewUpdate.aspx.vb" startLineNumber="261" endLineNumber="267"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\Resend.aspx.vb" startLineNumber="1020" endLineNumber="1026"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\RecipList.aspx.vb" startLineNumber="305" endLineNumber="311"/>
            <text>
                <![CDATA[
        objRoot.AppendChild(element)        element.AppendChild(elementTxt)

        element = objDom.CreateElement("formeffctivedate")
        elementTxt = objDom.CreateTextNode(formeffdate)
        objRoot.AppendChild(element)
        element.AppendChild(elementTxt)
                ]]>
            </text>
        </set>
        <set lineCount="6">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\Resend.aspx.vb" startLineNumber="291" endLineNumber="296"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\Resend.aspx.vb" startLineNumber="281" endLineNumber="286"/>
            <text>
                <![CDATA[
            Dim filepath As String = appSettings("GridStyle")            wgOutGoing.LoadPreset(filepath, True)
            wgOutGoing.Width = Unit.Pixel(750)
            wgOutGoing.Height = Unit.Pixel(165)
            Return
        End If
                ]]>
            </text>
        </set>
        <set lineCount="6">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\WCDocOpen.aspx.vb" startLineNumber="170" endLineNumber="175"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\ViewUpdate.aspx.vb" startLineNumber="126" endLineNumber="131"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="2014" endLineNumber="2019"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\Resend.aspx.vb" startLineNumber="869" endLineNumber="874"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\Resend.aspx.vb" startLineNumber="818" endLineNumber="823"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\RecipList.aspx.vb" startLineNumber="188" endLineNumber="193"/>
            <text>
                <![CDATA[
        If Not stream = "" Then            Dim xmlFcabReq As New System.Xml.XmlDocument
            xmlFcabReq.LoadXml(stream)
            Dim errorText As String = ""
            Dim ErrOccurred As Boolean = ErrCheck(xmlFcabReq, errorText)
            If ErrOccurred Then
                ]]>
            </text>
        </set>
        <set lineCount="6">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\PhotowebPicopen.aspx.vb" startLineNumber="276" endLineNumber="281"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\PhotowebPicopen.aspx.vb" startLineNumber="240" endLineNumber="245"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\PhotowebPicopen.aspx.vb" startLineNumber="62" endLineNumber="67"/>
            <text>
                <![CDATA[
        Catch ex As Exception            ExceptionManager.Publish(ex)
            uiHelper.DisplayPopupMessage(Me.Page, Me.Page.GetType, ex.Message.Replace("'", "\'"))
            uiHelper.DisplayMessages(Me.Page, Me.Page.GetType, lblErrorMessage, _
            ex.Message, Travelers.Claim.PortalBase.UI.Helper.MsgPriority.Critical)
        End Try
                ]]>
            </text>
        </set>
        <set lineCount="6">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="1372" endLineNumber="1380"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="1091" endLineNumber="1099"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="979" endLineNumber="986"/>
            <text>
                <![CDATA[
                rec1.SetXml(reqNodeList)
                req(0) = rec1.GetRecordValue()
                retVal = mq.SendReceive(APP, TRAN & "_" & appSettings("Host_Series"), req, ret, strErr)

                If retVal <> 0 Then
                    stRetRecs = stRetRecs + CreateErrorXML(retVal, strErr)
                    Return stRetRecs
                ]]>
            </text>
        </set>
        <set lineCount="6">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="3861" endLineNumber="3867"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="3254" endLineNumber="3260"/>
            <text>
                <![CDATA[
        lob = wsLOB.GetState("claimblock", "lob")
        secureBDEFolder = isSecureFolder("BDE Review", lob, Me.Context)

        If _clmBlkuserAfo = "404" Then
            secureCoverageFolder = isSecureFolder("Coverage", lob, Me.Context)
        Else
                ]]>
            </text>
        </set>
        <set lineCount="6">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\ViewUpdate.aspx.vb" startLineNumber="92" endLineNumber="97"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5099" endLineNumber="5104"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\RecipList.aspx.vb" startLineNumber="157" endLineNumber="162"/>
            <text>
                <![CDATA[
        stUserId = wp.Identity.Name.Split(CType("\", Char))(1).ToUpper        If Not stUserId = "" Then
            stUserId = stUserId.ToUpper()
        Else
            stUserId = ""
        End If
                ]]>
            </text>
        </set>
        <set lineCount="7">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\Resend.aspx.vb" startLineNumber="391" endLineNumber="398"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\Resend.aspx.vb" startLineNumber="502" endLineNumber="509"/>
            <text>
                <![CDATA[
                End If            End If
        Next

        If lblErrorMessage.Visible = True Then
            lblErrorMessage.Visible = False
            lblErrorMessage.Text = ""
        End If
                ]]>
            </text>
        </set>
        <set lineCount="7">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5082" endLineNumber="5088"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="6118" endLineNumber="6124"/>
            <text>
                <![CDATA[
        'loadRecordGrid(removeDeletedNode(keyvalue, _stFcabDetailWSRecords))        'updateFolderCount(_stFcabDetailWSRecords)
        uwgFileCabinet.Columns.Clear()
        loadRecordGrid(_stFcabDetailWSRecords)
        setFolderCounts()
        setFolderToAll()
        If Not stFcabSave = "" Then
                ]]>
            </text>
        </set>
        <set lineCount="7">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5623" endLineNumber="5629"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\ViewUpdate.aspx.vb" startLineNumber="641" endLineNumber="647"/>
            <text>
                <![CDATA[
    Private Function CreateAppendelement(ByVal parentNode As XmlNode, ByVal name As String, Optional ByVal text As String = Nothing) As XmlElement        Dim element As XmlElement = parentNode.OwnerDocument.CreateElement(name)
        If Not (text Is Nothing) Then
            element.InnerText = text
        End If
        parentNode.AppendChild(element)
        Return element
                ]]>
            </text>
        </set>
        <set lineCount="7">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\filepath.vb" startLineNumber="29" endLineNumber="37"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\filepath.vb" startLineNumber="103" endLineNumber="111"/>
            <text>
                <![CDATA[
        Dim mailMessage As New System.Net.Mail.MailMessage        Dim ws As WebState
        ws = New WebState

        xmlRoot = xmlDoc.CreateElement("EmailFaxRoot")
        xmlDoc.AppendChild(xmlRoot)

        xmlRootMessage = xmlDoc.CreateElement("EmailFaxXML")
        xmlRoot.AppendChild(xmlRootMessage)
                ]]>
            </text>
        </set>
        <set lineCount="7">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="835" endLineNumber="842"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5007" endLineNumber="5015"/>
            <text>
                <![CDATA[
                uiHelper.DisplayPopupMessage(Me.Page, Me.Page.GetType, "Search Failed. Please retry   " & ex.Message.ToString())                uiHelper.DisplayMessages(Me.Page, Me.Page.GetType, lblErrorMessage, "Search Failed. Please retry   " & ex.Message.ToString(), _
                            PortalBase.UI.Helper.MsgPriority.Critical)

                Exit Sub
            End Try

        End If
        If _ExcptInd Then
                ]]>
            </text>
        </set>
        <set lineCount="7">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="1473" endLineNumber="1482"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="1547" endLineNumber="1555"/>
            <text>
                <![CDATA[
        _stWebStateCountRecords = _stWebStateCountRecords.Trim()        _stFcabDetailWSRecords = _stFcabDetailWSRecords.Trim()

        If _stFcabDetailWSRecords = "" Or _stWebStateCountRecords = "" Then
            Try
                getCountsAndRecordsFromHost()
            Catch ex
                ' QC Defect ID:733  Modified By: MKANNAN3 Modified Date: 09/25/2009
                lblErrorMessage.Style.Add("display", "inline")
                ]]>
            </text>
        </set>
        <set lineCount="7">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="1450" endLineNumber="1457"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5043" endLineNumber="5050"/>
            <text>
                <![CDATA[
        If pageSubmit.Value = "reload" Then            pageSubmit.Value = ""   'reset to empty
            _stWebStateCountRecords = _stWebStateCountRecords.Trim()
            _stFcabDetailWSRecords = _stFcabDetailWSRecords.Trim()
            'ACCESS COUNT AND DOCUMENTS BASED ON SELECTION CRETIER if it was changed            
            If _stFcabDetailWSRecords = "" Or _stWebStateCountRecords = "" Then
                Try
                    getCountsAndRecordsFromHost()
                ]]>
            </text>
        </set>
        <set lineCount="7">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\filepath.vb" startLineNumber="47" endLineNumber="55"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\filepath.vb" startLineNumber="117" endLineNumber="127"/>
            <text>
                <![CDATA[
        xmlRootMessage.AppendChild(xmlEle)
        'If you want multiple recipients, you could write code to separate the shortnames
        ' with commas, and then put them all in this innertext
        xmlEle = xmlDoc.CreateElement("strFrom")
        xmlEle.InnerText = ws.GetState("Email", "MailFrom") '"ptruong@spt.com" 'Page.User.Identity.Name.Substring(Page.User.Identity.Name.IndexOf("\") + 1).ToUpper & "@spt.com" '"ptruong@stpaultravelers.com" 'mailMessage.From
        xmlRootMessage.AppendChild(xmlEle)

        xmlEle = xmlDoc.CreateElement("strSubject")
        xmlEle.InnerText = ws.GetState("Email", "MailSubject") '"test" 'Request.Form("RPTdata4") '"test" 'mailMessage.Subject
        xmlRootMessage.AppendChild(xmlEle)
                ]]>
            </text>
        </set>
        <set lineCount="7">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="824" endLineNumber="832"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="4996" endLineNumber="5004"/>
            <text>
                <![CDATA[
        Dim ex As Exception = Nothing
        _stWebStateCountRecords = _stWebStateCountRecords.Trim()
        _stFcabDetailWSRecords = _stFcabDetailWSRecords.Trim()

        If _stFcabDetailWSRecords = "" Or _stWebStateCountRecords = "" Then

            Try
                getCountsAndRecordsFromHost()
                ]]>
            </text>
        </set>
        <set lineCount="7">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\RecipList.aspx.vb" startLineNumber="169" endLineNumber="175"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\ViewUpdate.aspx.vb" startLineNumber="106" endLineNumber="112"/>
            <text>
                <![CDATA[
            Dim FcabWS As New TravelersFileCabinetWebService.TravelersFileCabinetWebService            FcabWS.Url = appSettings("TravelersFileCabinet.TravelersFileCabinetWebService.TravelersFileCabinetWebService")
            FcabWS.PreAuthenticate = True
            FcabWS.Credentials = [Global].myNetworkCache
            stream = FcabWS.GetSingleRecordWC(request)
        Catch fsRet As Exception
            ExceptionManager.Publish(fsRet)
                ]]>
            </text>
        </set>
        <set lineCount="7">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="219" endLineNumber="226"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="639" endLineNumber="646"/>
            <text>
                <![CDATA[
            Dim ex As Exception            Dim retVal As Long
            Dim oXmlRequest As New XmlDocument()
            Dim oFCDataXmlNode As XmlNode
            _Function = InsertFcabRec.ToString()

            Try
                oXmlRequest.LoadXml(xmlRequest)
                ]]>
            </text>
        </set>
        <set lineCount="7">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="1570" endLineNumber="1576"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="1509" endLineNumber="1515"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5031" endLineNumber="5037"/>
            <text>
                <![CDATA[
        loadDdlInOutList()
        Dim ws As WebState = New WebState
        Dim stFcSave As String = "FCSAVE"
        Dim stFcabSave As String = ws.GetState("FILECABSAVE", stFcSave.ToString())
        stFcabSave = stFcabSave.Trim()
        If Not stFcabSave = "" Then
                ]]>
            </text>
        </set>
        <set lineCount="7">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="1781" endLineNumber="1787"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="1913" endLineNumber="1919"/>
            <text>
                <![CDATA[
        stUserId = Page.User.Identity.Name.Substring(Page.User.Identity.Name.IndexOf("\") + 1)        If Not stUserId = "" Then
            stUserId = stUserId.ToUpper()
        Else
            stUserId = strLocalUserId
        End If
        sRequest = BuildRequestXMLString(stReqRecId, stUserId, "request")
                ]]>
            </text>
        </set>
        <set lineCount="7">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\Global.asax.vb" startLineNumber="12" endLineNumber="34"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\Global.asax.vb" startLineNumber="14" endLineNumber="36"/>
            <text>
                <![CDATA[
        Public Sub New()            MyBase.New()

            'This call is required by the Component Designer.
            InitializeComponent()

            'Add any initialization after the InitializeComponent() call

        End Sub

        'Required by the Component Designer
        Private components As System.ComponentModel.IContainer

        'NOTE: The following procedure is required by the Component Designer
        'It can be modified using the Component Designer.
        'Do not modify it using the code editor.
        <System.Diagnostics.DebuggerStepThrough()> Private Sub InitializeComponent()
            components = New System.ComponentModel.Container()
        End Sub

#End Region

        Sub Application_Start(ByVal sender As Object, ByVal e As EventArgs)
                ]]>
            </text>
        </set>
        <set lineCount="7">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="621" endLineNumber="627"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="660" endLineNumber="666"/>
            <text>
                <![CDATA[
                    Dim errorText As String = ""                    Dim ErrOccurred As Boolean = ErrCheck(xmlFcabReq, errorText)
                    If ErrOccurred Then
                        Dim uiHelper As New Travelers.Claim.PortalBase.UI.Helper
                        uiHelper.DisplayPopupMessage(Me.Page, Me.Page.GetType, errorText.ToString())
                        uiHelper.DisplayMessages(Me.Page, Me.Page.GetType, lblErrorMessage, errorText.ToString(), _
                                    PortalBase.UI.Helper.MsgPriority.Critical)
                ]]>
            </text>
        </set>
        <set lineCount="7">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="848" endLineNumber="857"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="2407" endLineNumber="2415"/>
            <text>
                <![CDATA[
            ddlSubFolder.Items.Clear()        End If

        _SubFolderId = ""
        _SubFolderText = ""

        If Not _FolderText = "" And _FolderId = "" Then
            _FolderId = FindFolderID(_FolderText.ToString())
        End If
                ]]>
            </text>
        </set>
        <set lineCount="7">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\Resend.aspx.vb" startLineNumber="1054" endLineNumber="1060"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="4796" endLineNumber="4802"/>
            <text>
                <![CDATA[
            'formid|formeffdate|datetimestamp|mediacode            DateTimeStamp = aryStr(2)
        End If
        Dim timestamp As New StringBuilder
        For Each c As Char In DateTimeStamp.ToCharArray
            If Char.IsDigit(c) Then
                timestamp.Append(c)
                ]]>
            </text>
        </set>
        <set lineCount="7">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="40" endLineNumber="47"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="98" endLineNumber="105"/>
            <text>
                <![CDATA[
                oFCDataXmlNode.InnerXml = _Function.ToString()            Catch ex
                ExceptionManager.Publish(ex)
                stRet = stRet + CreateErrorXML(1, ex.ToString())
                Return stRet
            End Try

            Try
                ]]>
            </text>
        </set>
        <set lineCount="7">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="4820" endLineNumber="4827"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="4845" endLineNumber="4851"/>
            <text>
                <![CDATA[
                    wipfilepath.Append(DateTimeStamp)                    Return wipfilepath.ToString
                Else
                    filePath.Append("TMATELETTERS")
                    filePath.Append(DateTimeStamp.Substring(2, 2))
                    filePath.Append("\")
                    filePath.Append(claimnumber.Substring(5, 2))
                ]]>
            </text>
        </set>
        <set lineCount="7">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="4562" endLineNumber="4570"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5647" endLineNumber="5653"/>
            <text>
                <![CDATA[
        Dim _clmBlkBenfitState As String = ws.GetState("claimblock", "adjusted-state")
        Dim delimiterStr As String = "_"
        Dim delimiter As Char() = delimiterStr.ToCharArray()
        Dim aryStr() As String = keyvalue.Split(delimiter)
        If aryStr.Length > 0 Then
            formid = aryStr(0)
                ]]>
            </text>
        </set>
        <set lineCount="7">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="247" endLineNumber="254"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="350" endLineNumber="357"/>
            <text>
                <![CDATA[
                    If bnSearch.Enabled = False Then 'This indicates there is a PERS Sub Verb Error                        bnAdd.Enabled = False
                    End If
                    Exit Sub
                End If

                _stFcabDetailWSRecords = _stFcabDetailWSRecords.Trim()
                _stWebStateCountRecords = _stWebStateCountRecords.Trim()
                ]]>
            </text>
        </set>
        <set lineCount="7">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="3997" endLineNumber="4003"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="4010" endLineNumber="4017"/>
            <text>
                <![CDATA[
        If _xmlCountRecords Is Nothing Then            'only for WC claim nov-2005
            If Not _clmBlksystemSource = WCsystemSourceCode Then
                stRetVal = "[000] [000] "
            Else
                stRetVal = " [000]"
            End If
            Return stRetVal
                ]]>
            </text>
        </set>
        <set lineCount="7">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="6130" endLineNumber="6138"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="6147" endLineNumber="6155"/>
            <text>
                <![CDATA[
    End Sub    Private Sub btnFax_Click()
        Dim fpath As New FilePath
        'Dim File_path(10) As String
        Dim File_ListData As New System.Text.StringBuilder

        Try
            If Request.Form("emailaction") <> "" Then
                File_ListData = buildFilestring()
                ]]>
            </text>
        </set>
        <set lineCount="7">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="1410" endLineNumber="1417"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="1483" endLineNumber="1490"/>
            <text>
                <![CDATA[
            Catch ex                ExceptionManager.Publish(ex)
                Return False
            End Try

            Try
                Dim oClmMqHelper As MQ.IMQHelper
                oClmMqHelper = New Travelers.Claim.Data.MQ.MQHelper
                ]]>
            </text>
        </set>
        <set lineCount="7">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="2664" endLineNumber="2670"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="2679" endLineNumber="2685"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="2705" endLineNumber="2711"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="2720" endLineNumber="2726"/>
            <text>
                <![CDATA[
                        If _clmBlksystemSource = WCsystemSourceCode Then
                            uwgFileCabinet.DisplayLayout.Bands(0).Columns(idxDv).Hidden = False
                            uwgFileCabinet.Columns(idxDv).Width = Unit.Pixel(100)
                        Else
                            uwgFileCabinet.DisplayLayout.Bands(0).Columns(idxDv).Hidden = True
                            uwgFileCabinet.Columns(idxDv).Width = Unit.Pixel(0)
                ]]>
            </text>
        </set>
        <set lineCount="7">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5115" endLineNumber="5123"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\ViewUpdate.aspx.vb" startLineNumber="154" endLineNumber="163"/>
            <text>
                <![CDATA[
        End If
        Dim dtlXML As New XmlDocument
        dtlXML.LoadXml(stRetReq)

        Dim stHdrNode As String = xmlReqDoc.SelectSingleNode("request").InnerXml
        Dim stDtlNode As String = dtlXML.SelectSingleNode("datafields").InnerXml
        Dim stActualRequest As String = "<request>" & stHdrNode.ToString() & stDtlNode.ToString() & "</request>"

        Return stActualRequest
                ]]>
            </text>
        </set>
        <set lineCount="7">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="2005" endLineNumber="2013"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\ViewUpdate.aspx.vb" startLineNumber="118" endLineNumber="126"/>
            <text>
                <![CDATA[
            Return String.Empty            Exit Function
        End Try
        If Not stream = "" Then
            stream = stream.Trim()
        End If

        'check error in host return string
        If Not stream = "" Then
                ]]>
            </text>
        </set>
        <set lineCount="8">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="1310" endLineNumber="1317"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="860" endLineNumber="869"/>
            <text>
                <![CDATA[
        Dim stFolderName As String = ""        Dim intSelIdx As Integer = ddlFolders.SelectedIndex

        If intSelIdx > -1 Then
            'only for WC claim nov-2005
            If _clmBlksystemSource = WCsystemSourceCode Then
                stFolderNameAndCounts = ddlFolders.SelectedItem.ToString()
                stFolderName = stFolderNameAndCounts.Substring(0, stFolderNameAndCounts.IndexOf("["))
                stFolderName = stFolderName.Trim
            Else
                ]]>
            </text>
        </set>
        <set lineCount="8">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5058" endLineNumber="5067"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="1491" endLineNumber="1500"/>
            <text>
                <![CDATA[
        End If
        validateFromAndToDates()
        If _DateErrorFound Then
            clearSelectedFilters()
            Exit Sub
        End If

        setTitleFilter()
        setRecpFilter()
                ]]>
            </text>
        </set>
        <set lineCount="8">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\ViewUpdate.aspx.vb" startLineNumber="742" endLineNumber="750"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5463" endLineNumber="5471"/>
            <text>
                <![CDATA[
            End If            If strFormid = "C24757MEDB" Or strFormid = "C25205MEDB" Then
                Return "MedBill"
            End If
            Return ConvertMediaCode(strSource)
        Else
            Return strSource
        End If
        Return strSource
                ]]>
            </text>
        </set>
        <set lineCount="8">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5362" endLineNumber="5370"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5287" endLineNumber="5294"/>
            <text>
                <![CDATA[
                        loadDdlInOutList()                        If Not stFcabSave = "" Then setSaveFields(stFcabSave)
                        uwgFileCabinet.Columns.Clear()
                        loadRecordGrid(removeDeletedNode(keyvalue, _stFcabDetailWSRecords))
                        updateFolderCount(_stFcabDetailWSRecords)
                        setFolderCounts()
                        setFolderToAll()
                        If Not stFcabSave = "" Then
                ]]>
            </text>
        </set>
        <set lineCount="8">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="693" endLineNumber="700"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="633" endLineNumber="641"/>
            <text>
                <![CDATA[
            End If
        Catch ex
            _ExcptInd = True
            ExceptionManager.Publish(ex)
            ddlTitle.Enabled = False
            ddlSenderName.Enabled = False
            ddlRecipName.Enabled = False
            Dim uiHelper As New Travelers.Claim.PortalBase.UI.Helper
                ]]>
            </text>
        </set>
        <set lineCount="8">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\ViewUpdate.aspx.vb" startLineNumber="90" endLineNumber="97"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5097" endLineNumber="5104"/>
            <text>
                <![CDATA[
        Dim stReqRecId As String = "WCFCCG"
        Dim wp As New WindowsPrincipal(WindowsIdentity.GetCurrent())
        stUserId = Page.User.Identity.Name.Substring(Page.User.Identity.Name.IndexOf("\") + 1)
        stUserId = wp.Identity.Name.Split(CType("\", Char))(1).ToUpper
        If Not stUserId = "" Then
            stUserId = stUserId.ToUpper()
        Else
                ]]>
            </text>
        </set>
        <set lineCount="8">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="3323" endLineNumber="3330"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="3170" endLineNumber="3177"/>
            <text>
                <![CDATA[
        If _clmBlksystemSource = WCsystemSourceCode Then            _ccaCreateAnotherXmldoc.Load(strXMLCCACreateAnotherPath)
            If stFcabReturn.Length > 0 Then
                Dim objDom As New XmlDocument
                objDom.LoadXml(stFcabReturn)
                xmlEvalList = objDom.SelectNodes("//FileCabSave")
                If xmlEvalList.Count > 0 Then
                    Dim saveNode As XmlNode = xmlEvalList.Item(0)
                ]]>
            </text>
        </set>
        <set lineCount="8">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5640" endLineNumber="5648"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5203" endLineNumber="5210"/>
            <text>
                <![CDATA[
        End If
        _clmBlknumber = ws.GetState("claimblock", "number")
        _cmtBlkNumber = ws.GetState("claimant", "number")
        _clmBlkAfo = ws.GetState("claimblock", "afo")
        _clmBlkafoType = ws.GetState("claimblock", "afo-type")
        _clmBlkuserAfo = ws.GetState("claimblock", "user-afo")
        Dim _clmBlkBenfitState As String = ws.GetState("claimblock", "adjusted-state")
                ]]>
            </text>
        </set>
        <set lineCount="8">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="1493" endLineNumber="1501"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="1422" endLineNumber="1430"/>
            <text>
                <![CDATA[
                Dim msg_id As String = Nothing                Dim strErr As String = Nothing
                Dim cohostLayout As New XmlDocument
                Dim drvLtr As String = appSettings("Drive")
                Dim stLayoutPath As String = appSettings("Host_Record")

                Try
                    cohostLayout.Load(drvLtr.ToString() & stLayoutPath.ToString())
                    Dim rec1 As coHostRecordHelper.coHostRecord
                ]]>
            </text>
        </set>
        <set lineCount="8">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\Resend.aspx.vb" startLineNumber="1020" endLineNumber="1029"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\ViewUpdate.aspx.vb" startLineNumber="261" endLineNumber="271"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\RecipList.aspx.vb" startLineNumber="305" endLineNumber="315"/>
            <text>
                <![CDATA[
        objRoot.AppendChild(element)        element.AppendChild(elementTxt)

        element = objDom.CreateElement("formeffctivedate")
        elementTxt = objDom.CreateTextNode(formeffdate)
        objRoot.AppendChild(element)
        element.AppendChild(elementTxt)

        stRetrun = objDom.InnerXml.ToString()

        Return stRetrun
                ]]>
            </text>
        </set>
        <set lineCount="8">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="389" endLineNumber="397"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="346" endLineNumber="354"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="229" endLineNumber="237"/>
            <text>
                <![CDATA[
                    getCountsAndRecordsFromHost()                    If _ExcptInd = True Then
                        bnAdd.Enabled = True
                        'QC Bug Fix - 1755 SPARAMA2
                        If bnSearch.Enabled = False Then 'This indicates there is a PERS Sub Verb Error
                            bnAdd.Enabled = False
                        End If
                        Exit Sub
                    End If
                ]]>
            </text>
        </set>
        <set lineCount="8">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="6022" endLineNumber="6031"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5200" endLineNumber="5208"/>
            <text>
                <![CDATA[
            '            PortalBase.UI.Helper.MsgPriority.Critical)
            Exit Sub
        End If

        _clmBlknumber = ws.GetState("claimblock", "number")
        _cmtBlkNumber = ws.GetState("claimant", "number")
        _clmBlkAfo = ws.GetState("claimblock", "afo")
        _clmBlkafoType = ws.GetState("claimblock", "afo-type")
                ]]>
            </text>
        </set>
        <set lineCount="8">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="4190" endLineNumber="4203"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="4133" endLineNumber="4146"/>
            <text>
                <![CDATA[
            uiHelper.DisplayPopupMessage(Me.Page, Me.Page.GetType, "Unable to save SLGCCA Document Name.  Please retry  " & ex.Message.ToString())            uiHelper.DisplayMessages(Me.Page, Me.Page.GetType, lblErrorMessage, "Unable to save SLGCCA Document Name.  Please retry  " & ex.Message.ToString(), _
                        PortalBase.UI.Helper.MsgPriority.Critical)

            Exit Sub
        End Try

        '  SLGCCAOPEN.ASPX IS A DUMMY PAGE THAT WILL BE CALLED THEN LAUNCH
        '  SLGCCA'S DOCOPEN PAGE AND POINT BACK TO THIS PAGE.  SEE JAVASCRIPT IN 
        '  THE TOP OF SLGCCAOPEN.ASPX FOR THE ACTUAL CALL CODE

        setFcabSaveToFromFreeForm("Y")

        Try
                ]]>
            </text>
        </set>
        <set lineCount="8">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="452" endLineNumber="460"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="368" endLineNumber="376"/>
            <text>
                <![CDATA[
            _Function = SearchForFcabRecs.ToString()            Dim stRetRecs As String = Nothing
            Dim ex As Exception
            Dim xmlInput As New XmlDocument()

            Try
                xmlInput.LoadXml(xmlRequest)
            Catch ex
                ExceptionManager.Publish(ex)
                ]]>
            </text>
        </set>
        <set lineCount="8">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5958" endLineNumber="5968"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5807" endLineNumber="5817"/>
            <text>
                <![CDATA[
                                        Travelers.Claim.PortalBase.UI.Helper.MsgPriority.Critical)
            End If

        Catch ex As Exception
            'Set the error label on the page and invoke a Pop-up message with the error.
            Dim uiHelper As New Travelers.Claim.PortalBase.UI.Helper
            uiHelper.DisplayPopupMessage(Me.Page, Me.Page.GetType, ex.Message)
            uiHelper.DisplayMessages(Me.Page, Me.Page.GetType, lblErrorMessage, ex.Message, _
                                    Travelers.Claim.PortalBase.UI.Helper.MsgPriority.Critical)
            'Also Publish this error to the Exception Manager
                ]]>
            </text>
        </set>
        <set lineCount="9">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="491" endLineNumber="502"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="49" endLineNumber="58"/>
            <text>
                <![CDATA[
                Dim req(0) As String                Dim ret() As String = Nothing
                Dim rec1 As coHostRecordHelper.coHostRecord
                Dim cohostLayout As New XmlDocument()
                Dim drvLtr As String = appSettings("Drive")
                Dim stLayoutPath As String = appSettings("Host_Record")

                Try
                    cohostLayout.Load(drvLtr.ToString() & stLayoutPath.ToString())
                    rec1 = New coHostRecordHelper.coHostRecord(cohostLayout.SelectSingleNode("host-records/definitions/request"))
                ]]>
            </text>
        </set>
        <set lineCount="9">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="301" endLineNumber="314"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="383" endLineNumber="395"/>
            <text>
                <![CDATA[
            Dim reqXMLNode As XmlNode
            reqXMLNode = xmlInput.SelectSingleNode("request/hdractivity")

            If reqXMLNode Is Nothing Then
                'stRetRecs = stRetRecs + CreateErrorXML(1, "Invalid Request Record")
                Return stRetRecs
            End If
            'get the value of the hdrsubverb node and update it to be FILECAB
            Try
                reqXMLNode.InnerXml = _Function.ToString()
            Catch ex
                ExceptionManager.Publish(ex)
                ]]>
            </text>
        </set>
        <set lineCount="9">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\Resend.aspx.vb" startLineNumber="1155" endLineNumber="1164"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\Resend.aspx.vb" startLineNumber="1249" endLineNumber="1258"/>
            <text>
                <![CDATA[
            End Select        Next

        Dim colSel As New Infragistics.WebUI.UltraWebGrid.UltraGridColumn
        colSel.IsBound = True
        colSel.Header.Caption = "Sel"
        colSel.Key = "Sel"
        colSel.Type = ColumnType.CheckBox
        colSel.AllowUpdate = AllowUpdate.Yes
        colSel.Width = Unit.Pixel(35)
                ]]>
            </text>
        </set>
        <set lineCount="9">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\RecipList.aspx.vb" startLineNumber="185" endLineNumber="193"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\Resend.aspx.vb" startLineNumber="815" endLineNumber="823"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\ViewUpdate.aspx.vb" startLineNumber="121" endLineNumber="131"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\Resend.aspx.vb" startLineNumber="866" endLineNumber="874"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\WCDocOpen.aspx.vb" startLineNumber="167" endLineNumber="175"/>
            <text>
                <![CDATA[
        If Not stream = "" Then            stream = stream.Trim()
        End If
        If Not stream = "" Then
            Dim xmlFcabReq As New System.Xml.XmlDocument
            xmlFcabReq.LoadXml(stream)
            Dim errorText As String = ""
            Dim ErrOccurred As Boolean = ErrCheck(xmlFcabReq, errorText)
            If ErrOccurred Then
                ]]>
            </text>
        </set>
        <set lineCount="9">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="369" endLineNumber="380"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="288" endLineNumber="299"/>
            <text>
                <![CDATA[
            Dim stRetRecs As String = Nothing            Dim ex As Exception
            Dim xmlInput As New XmlDocument()

            Try
                xmlInput.LoadXml(xmlRequest)
            Catch ex
                ExceptionManager.Publish(ex)
                'stRetRecs = stRetRecs + CreateErrorXML(1, "Invalid request record ")
                'stRetRecs = stRetRecs + GetComputerInfo()
                Return stRetRecs
            End Try
                ]]>
            </text>
        </set>
        <set lineCount="9">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="886" endLineNumber="894"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5020" endLineNumber="5029"/>
            <text>
                <![CDATA[
        'for WC claim nov-2005 reset before loading grid
        ddlTitle.ClearSelection()
        ddlTitle.SelectedIndex = -1
        ddlSenderName.ClearSelection()
        ddlSenderName.SelectedIndex = -1

        If Not _stFcabDetailWSRecords = "" Then
            loadFilterListBoxes(_stFcabDetailWSRecords)
        End If
                ]]>
            </text>
        </set>
        <set lineCount="9">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\RecipList.aspx.vb" startLineNumber="43" endLineNumber="53"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\ViewUpdate.aspx.vb" startLineNumber="42" endLineNumber="52"/>
            <text>
                <![CDATA[
        Dim keyValue As String = Request.QueryString.Get("KEYVALUE")        'Dim keyValue As String = "C25449_1993-01-01_2007-05-31-19.10.53.000000_M__1_"
        Dim delimiterStr As String = "_"
        Dim delimiter As Char() = delimiterStr.ToCharArray()
        Dim aryStr() As String = keyValue.Split(delimiter)
        If aryStr.Length > 0 Then
            'formid|formeffdate|datetimestamp|mediacode
            formid = aryStr(0)
            formeffdate = aryStr(1)
            datetimestamp = aryStr(2)
        End If
                ]]>
            </text>
        </set>
        <set lineCount="9">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="216" endLineNumber="224"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="290" endLineNumber="298"/>
            <text>
                <![CDATA[
            Try                If uwgFileCabinet.Rows.Count > 0 Then
                    uwgFileCabinet.Visible = True
                Else
                    uwgFileCabinet.Visible = False
                End If
            Catch exx As Exception
                uwgFileCabinet.Visible = False
            End Try
                ]]>
            </text>
        </set>
        <set lineCount="9">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="1060" endLineNumber="1074"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="4015" endLineNumber="4028"/>
            <text>
                <![CDATA[
                stRetVal = " [000]"            End If
            Return stRetVal

        End If

        ' NOW RETRIEVE THE IN RANGE COUNT AND OUT OF RANGE COUNTS FROM THE XML STRING IN WEB STATE

        Dim objNode As XmlNode
        Dim stFolder As String = ""
        Dim stSubFolder As String = ""
        Dim stRCount As String = ""
        Dim stTCount As String = ""
        Dim stRet As String = ""
                ]]>
            </text>
        </set>
        <set lineCount="9">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5593" endLineNumber="5601"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\ViewUpdate.aspx.vb" startLineNumber="604" endLineNumber="612"/>
            <text>
                <![CDATA[
        CreateAppendelement(objRoot, "archivedt", "")        CreateAppendelement(objRoot, "sensitiveind", "")
        CreateAppendelement(objRoot, "attnyclientind")
        CreateAppendelement(objRoot, "recreatebutton")
        CreateAppendelement(objRoot, "deletebutton")
        CreateAppendelement(objRoot, "printbutton")
        CreateAppendelement(objRoot, "detailbutton")
        CreateAppendelement(objRoot, "viewbutton")
        CreateAppendelement(objRoot, "resendbutton")
                ]]>
            </text>
        </set>
        <set lineCount="9">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\DocOpenStart.aspx.vb" startLineNumber="10" endLineNumber="28"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\SLGCCAOPEN.aspx.vb" startLineNumber="9" endLineNumber="27"/>
            <text>
                <![CDATA[
    <System.Diagnostics.DebuggerStepThrough()> Private Sub InitializeComponent()
    End Sub

    Private Sub Page_Init(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Init
        'CODEGEN: This method call is required by the Web Form Designer
        'Do not modify it using the code editor.
        InitializeComponent()
    End Sub

#End Region

    Private Sub Page_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        'Put user code to initialize the page here
        If verifyData(Request.Form, Request.Cookies, Request.QueryString) Then
            Response.Write("Error - Suspect characters have been detected.")
            Response.End()
            Exit Sub
        End If
                ]]>
            </text>
        </set>
        <set lineCount="9">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="1507" endLineNumber="1515"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5028" endLineNumber="5037"/>
            <text>
                <![CDATA[
            loadFilterListBoxes(_stFcabDetailWSRecords)        End If
        setSaveScreenValues("N")
        loadDdlInOutList()

        Dim ws As WebState = New WebState
        Dim stFcSave As String = "FCSAVE"
        Dim stFcabSave As String = ws.GetState("FILECABSAVE", stFcSave.ToString())
        stFcabSave = stFcabSave.Trim()
        If Not stFcabSave = "" Then
                ]]>
            </text>
        </set>
        <set lineCount="9">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="158" endLineNumber="168"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="1172" endLineNumber="1182"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="2054" endLineNumber="2064"/>
            <text>
                <![CDATA[
            If _clmBlksystemSource = "W" Then                _clmBlksystemSource = _clmBlksystemSource & "C"
            End If

            If _clmBlksystemSource = "C" Then
                _clmBlksystemSource = _clmBlksystemSource & "L"
            End If

            If _clmBlksystemSource = "P" Then
                _clmBlksystemSource = _clmBlksystemSource & "L"
            End If
                ]]>
            </text>
        </set>
        <set lineCount="9">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="4302" endLineNumber="4310"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="4114" endLineNumber="4122"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="4171" endLineNumber="4179"/>
            <text>
                <![CDATA[
        'PAGE BY PASSING THE INSTANCE ID AS A QUERY STRING 
        Dim ex As Exception
        If _InstanceID = "" Then
            Try
                _InstanceID = Request.QueryString("InstanceID")
            Catch T As System.Threading.ThreadAbortException
            Catch ex
                Exit Sub
                ]]>
            </text>
        </set>
        <set lineCount="10">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\Resend.aspx.vb" startLineNumber="1041" endLineNumber="1051"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\Resend.aspx.vb" startLineNumber="52" endLineNumber="62"/>
            <text>
                <![CDATA[
                Dim delimiterStr As String = "_"                Dim delimiter As Char() = delimiterStr.ToCharArray()
                Dim aryStr() As String = keyValue.Split(delimiter)
                If aryStr.Length > 2 Then
                    'formid|formeffdate|datetimestamp|mediacode
                    formid = aryStr(0)
                    formeffdate = aryStr(1)
                    datetimestamp = aryStr(2)
                Else
                    lblErrorMessage.Text = "KeyValue needs to contain more than 2 values."
                    lblErrorMessage.Visible = True
                ]]>
            </text>
        </set>
        <set lineCount="10">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="907" endLineNumber="917"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="965" endLineNumber="977"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="1358" endLineNumber="1370"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="1077" endLineNumber="1089"/>
            <text>
                <![CDATA[
            Try                Dim mq As MQ.IMQHelper
                mq = New Travelers.Claim.Data.MQ.MQHelper
                Dim req(0) As String
                Dim ret() As String = Nothing

                Dim rec1 As coHostRecordHelper.coHostRecord

                Dim cohostLayout As New XmlDocument
                Dim drvLtr As String = appSettings("Drive")
                Dim stLayoutPath As String = appSettings("Host_Record")

                cohostLayout.Load(drvLtr.ToString() & stLayoutPath.ToString())
                ]]>
            </text>
        </set>
        <set lineCount="10">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="4446" endLineNumber="4456"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="4248" endLineNumber="4258"/>
            <text>
                <![CDATA[
        End Try
        Try
            ws.SetState("FILECABSAVE", stFcSave.ToString(), objDom.InnerXml(), Travelers.Enterprise.StateManagement.DataType.CData)
            ws.SetProviderInfo("FILECABSAVE")
        Catch ex
            Dim uiHelper As New Travelers.Claim.PortalBase.UI.Helper
            uiHelper.DisplayPopupMessage(Me.Page, Me.Page.GetType, "Unable to save values.  Please retry   " & ex.Message.ToString())
            uiHelper.DisplayMessages(Me.Page, Me.Page.GetType, lblErrorMessage, "Unable to save values.  Please retry   " & ex.Message.ToString(), _
                        PortalBase.UI.Helper.MsgPriority.Critical)

                ]]>
            </text>
        </set>
        <set lineCount="10">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\ViewUpdate.aspx.vb" startLineNumber="766" endLineNumber="775"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5533" endLineNumber="5544"/>
            <text>
                <![CDATA[
        Return code    End Function
    Private Function ConvertPrintStatusCode(ByVal code As String) As String
        '  code decode candidate

        Dim strXMLMediaCodePath As String = Server.MapPath("XML\PrintStatusCode.xml")
        Dim xmldoc As New XmlDocument
        xmldoc.Load(strXMLMediaCodePath)
        Dim nodelist As XmlNodeList = xmldoc.SelectNodes("//CodeList/PrintStatusCode")
        For Each node As XmlNode In nodelist
            If node.Attributes.GetNamedItem("value").Value = code.ToUpper Then
                Return node.InnerText.ToString
                ]]>
            </text>
        </set>
        <set lineCount="10">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="921" endLineNumber="932"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="65" endLineNumber="77"/>
            <text>
                <![CDATA[
                Dim strErr As String = ""                req(0) = rec1.GetRecordValue()
                'mq = CType(Activator.CreateInstance(Type.GetTypeFromProgID("CoClmUtilMQ.CClmMQHelper")), Travelers.Claim.Data.MQ.IMQHelper)
                retVal = mq.SendReceive(APP, TRAN & "_" & appSettings("Host_Series"), req, ret, strErr)
                If retVal <> 0 Then
                    stRet = stRet + CreateErrorXML(retVal, strErr)
                    Return stRet
                End If

                Return String.Empty

            Catch ex
                ExceptionManager.Publish(ex)
                ]]>
            </text>
        </set>
        <set lineCount="10">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="2054" endLineNumber="2066"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="158" endLineNumber="170"/>
            <text>
                <![CDATA[
            If _clmBlksystemSource = "W" Then                _clmBlksystemSource = _clmBlksystemSource & "C"
            End If

            If _clmBlksystemSource = "C" Then
                _clmBlksystemSource = _clmBlksystemSource & "L"
            End If

            If _clmBlksystemSource = "P" Then
                _clmBlksystemSource = _clmBlksystemSource & "L"
            End If

        End If
                ]]>
            </text>
        </set>
        <set lineCount="10">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="468" endLineNumber="478"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="3338" endLineNumber="3348"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="326" endLineNumber="336"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="535" endLineNumber="545"/>
            <text>
                <![CDATA[
        If stToDt = "" Then            SetCalendarToDate()
        Else
            uwgToDate.Value = stToDt
        End If

        If stFromDt = "" Then
            SetCalendarFromDate()
        Else
            uwgFromDate.Value = stFromDt
        End If
                ]]>
            </text>
        </set>
        <set lineCount="10">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\ViewUpdate.aspx.vb" startLineNumber="666" endLineNumber="675"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5505" endLineNumber="5516"/>
            <text>
                <![CDATA[
        Return strStatusCode    End Function
    Private Function ConvertMediaCode(ByVal code As String) As String
        '  code decode candidate

        Dim strXMLMediaCodePath As String = Server.MapPath("XML\DetailMedacd.xml")
        Dim xmldoc As New XmlDocument
        xmldoc.Load(strXMLMediaCodePath)
        Dim nodelist As XmlNodeList = xmldoc.SelectNodes("//CodeList/MediaCode")
        For Each node As XmlNode In nodelist
            If node.Attributes.GetNamedItem("value").Value = code.ToUpper Then
                Return node.InnerText.ToString
                ]]>
            </text>
        </set>
        <set lineCount="10">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\Resend.aspx.vb" startLineNumber="559" endLineNumber="569"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\Resend.aspx.vb" startLineNumber="518" endLineNumber="528"/>
            <text>
                <![CDATA[
        End If
        Dim idx As Integer = getSelectedRow()
        If idx < 0 Then
            lblErrorMessage.Text = "User must select one row from Resend Details Grid"
            lblErrorMessage.Visible = True
            Exit Sub
        End If
        Dim seqnbr As String
        Dim objDom As New XmlDocument
        objDom.LoadXml(stOutGoingDetail)
                ]]>
            </text>
        </set>
        <set lineCount="10">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="577" endLineNumber="587"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="494" endLineNumber="505"/>
            <text>
                <![CDATA[
                Dim rec1 As coHostRecordHelper.coHostRecord
                Dim cohostLayout As New XmlDocument()
                Dim drvLtr As String = appSettings("Drive")
                Dim stLayoutPath As String = appSettings("Host_Record")

                Try
                    cohostLayout.Load(drvLtr.ToString() & stLayoutPath.ToString())
                    rec1 = New coHostRecordHelper.coHostRecord(cohostLayout.SelectSingleNode("host-records/definitions/request"))
                    rec1.SetXml(reqNodeList)
                Catch ex
                    ExceptionManager.Publish(ex)
                ]]>
            </text>
        </set>
        <set lineCount="10">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\Resend.aspx.vb" startLineNumber="384" endLineNumber="393"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\Resend.aspx.vb" startLineNumber="150" endLineNumber="159"/>
            <text>
                <![CDATA[
        Dim selRow As Integer = -1        Dim selRowsCount As Integer = 0
        For Each uwgRowRH As Infragistics.WebUI.UltraWebGrid.UltraGridRow In wgRecipHist.Rows
            If uwgRowRH.Cells.FromKey("Sel").Value.ToString.Equals("true") Then
                selRowsCount += 1
                If selRow = -1 Then
                    selRow = uwgRowRH.Index
                End If
            End If
        Next
                ]]>
            </text>
        </set>
        <set lineCount="11">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5493" endLineNumber="5503"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\ViewUpdate.aspx.vb" startLineNumber="754" endLineNumber="764"/>
            <text>
                <![CDATA[
        If strInOut = "O" Then            Return ConvertPrintStatusCode(strStatusCode)
        End If
        If strInOut = "I" Then
            If strFormid.IndexOf("CA49") = 0 Or strFormid.IndexOf("C148") = 0 Then    ' edi incoming doc
                Return ConvertPrintStatusCode(strStatusCode)
            Else
                strStatusCode = "Complete" 'prefill with complete
            End If
        End If
        Return strStatusCode
                ]]>
            </text>
        </set>
        <set lineCount="11">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="504" endLineNumber="517"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="1306" endLineNumber="1319"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="193" endLineNumber="204"/>
            <text>
                <![CDATA[
                Catch ex                    ExceptionManager.Publish(ex)
                    stRetRecs = stRetRecs + CreateErrorXML(1, ex.ToString())
                    Return stRetRecs
                End Try
                req(0) = rec1.GetRecordValue()
                ' mq = CType(Activator.CreateInstance(Type.GetTypeFromProgID("CoClmUtilMQ.CClmMQHelper")), Travelers.Claim.Data.MQ.IMQHelper)
                retVal = mq.SendReceive(APP, TRAN & "_" & appSettings("Host_Series"), req, ret, strErr)
                If retVal <> 0 Then
                    stRetRecs = stRetRecs + CreateErrorXML(retVal, strErr)
                    Return stRetRecs
                End If
                ]]>
            </text>
        </set>
        <set lineCount="11">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="1038" endLineNumber="1050"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="1162" endLineNumber="1174"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="132" endLineNumber="145"/>
            <text>
                <![CDATA[
                    If Not retVal = 0 Then                        stRet = stRet + CreateErrorXML(1, strErr.ToString())
                        Return stRet
                    Else
                        Return stRet
                    End If

                Catch ex
                    ExceptionManager.Publish(ex)
                    'Throw New BaseApplicationException(ex.ToString & " : " & "Base exception from FileCabinet DataObject PhotowebChangeReq")
                    'stRetRecs = stRetRecs + GetComputerInfo()
                    stRet = stRet + CreateErrorXML(1, ex.ToString())
                    Return stRet
                End Try
                ]]>
            </text>
        </set>
        <set lineCount="11">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="707" endLineNumber="719"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\TravelersFileCabinet.asmx.vb" startLineNumber="159" endLineNumber="171"/>
            <text>
                <![CDATA[
            Dim localXMLdoc As New Xml.XmlDocument()            Dim localnode As Xml.XmlNode = localXMLdoc.CreateNode(Xml.XmlNodeType.Element, "error", "")
            Dim localXMLElement As Xml.XmlElement

            localXMLElement = localXMLdoc.CreateElement("code")
            localXMLElement.InnerText = CStr(iInErrorCode)
            localnode.AppendChild(localXMLElement)

            localXMLElement = localXMLdoc.CreateElement("message")
            If iInErrorCode = 2033 Then
                localXMLElement.InnerText = "A time out has occurred trying to retrieve data from the host. " & _
                 "Please try again then call FOSS"
            Else
                ]]>
            </text>
        </set>
        <set lineCount="11">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\RecipList.aspx.vb" startLineNumber="183" endLineNumber="193"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\Resend.aspx.vb" startLineNumber="813" endLineNumber="823"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\ViewUpdate.aspx.vb" startLineNumber="119" endLineNumber="131"/>
            <text>
                <![CDATA[
            Exit Function        End Try
        If Not stream = "" Then
            stream = stream.Trim()
        End If

        'check error in host return string
        If Not stream = "" Then
            Dim xmlFcabReq As New System.Xml.XmlDocument
            xmlFcabReq.LoadXml(stream)
            Dim errorText As String = ""
            Dim ErrOccurred As Boolean = ErrCheck(xmlFcabReq, errorText)
            If ErrOccurred Then
                ]]>
            </text>
        </set>
        <set lineCount="11">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\Resend.aspx.vb" startLineNumber="266" endLineNumber="276"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5519" endLineNumber="5531"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\ViewUpdate.aspx.vb" startLineNumber="654" endLineNumber="664"/>
            <text>
                <![CDATA[
    Private Function ConvertGenerateFromCode(ByVal code As String) As String        Dim strXMLMediaCodePath As String = Server.MapPath("XML\GenerateFromCode.xml")
        Dim xmldoc As New XmlDocument
        xmldoc.Load(strXMLMediaCodePath)
        Dim nodelist As XmlNodeList = xmldoc.SelectNodes("//CodeList/GenerateFromCode")
        For Each node As XmlNode In nodelist
            If node.Attributes.GetNamedItem("value").Value = code.ToUpper Then
                Return node.InnerText.ToString
            End If
        Next
        Return code
                ]]>
            </text>
        </set>
        <set lineCount="12">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="1354" endLineNumber="1368"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="1073" endLineNumber="1087"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="1286" endLineNumber="1300"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="961" endLineNumber="975"/>
            <text>
                <![CDATA[
            Dim reqNodeList As XmlNodeList = xmlInput.SelectSingleNode("request").ChildNodes()
            Dim retVal As Long
            Dim strErr As String = Nothing
            Try
                Dim mq As MQ.IMQHelper
                mq = New Travelers.Claim.Data.MQ.MQHelper
                Dim req(0) As String
                Dim ret() As String = Nothing

                Dim rec1 As coHostRecordHelper.coHostRecord

                Dim cohostLayout As New XmlDocument
                Dim drvLtr As String = appSettings("Drive")
                Dim stLayoutPath As String = appSettings("Host_Record")
                ]]>
            </text>
        </set>
        <set lineCount="12">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5930" endLineNumber="5943"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5880" endLineNumber="5892"/>
            <text>
                <![CDATA[
                            For iuwgCols = 0 To uwgFileCabinet.Columns.Count - 1
                                If uwgFileCabinet.Columns.Item(iuwgCols).HeaderText.ToString = dtExport.Columns.Item(idsCols).ColumnName.ToString Then
                                    If uwgFileCabinet.Rows.Item(iRows).Cells(iuwgCols).Text = Nothing Then
                                        dtRow(idsCols) = Nothing
                                    Else
                                        dtRow.Item(idsCols) = uwgFileCabinet.Rows.Item(iRows).Cells(iuwgCols).Text
                                    End If
                                    Exit For

                                End If
                            Next
                        Next
                ]]>
            </text>
        </set>
        <set lineCount="12">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\Resend.aspx.vb" startLineNumber="866" endLineNumber="877"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\Resend.aspx.vb" startLineNumber="815" endLineNumber="826"/>
            <text>
                <![CDATA[
        If Not Stream = "" Then            Stream = Stream.Trim()
        End If
        If Not Stream = "" Then
            Dim xmlFcabReq As New System.Xml.XmlDocument
            xmlFcabReq.LoadXml(Stream)
            Dim errorText As String = ""
            Dim ErrOccurred As Boolean = ErrCheck(xmlFcabReq, errorText)
            If ErrOccurred Then
                lblErrorMessage.Text = errorText.ToString()
                lblErrorMessage.Visible = True
                Stream = ""
                ]]>
            </text>
        </set>
        <set lineCount="12">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\ViewUpdate.aspx.vb" startLineNumber="228" endLineNumber="241"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\RecipList.aspx.vb" startLineNumber="278" endLineNumber="291"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="2137" endLineNumber="2150"/>
            <text>
                <![CDATA[
        element = objDom.CreateElement("subfolder")        elementTxt = objDom.CreateTextNode("")
        objRoot.AppendChild(element)
        element.AppendChild(elementTxt)

        element = objDom.CreateElement("repositoryname")
        elementTxt = objDom.CreateTextNode("")
        objRoot.AppendChild(element)
        element.AppendChild(elementTxt)

        element = objDom.CreateElement("repositorykey")
        elementTxt = objDom.CreateTextNode("")
        objRoot.AppendChild(element)
        element.AppendChild(elementTxt)
                ]]>
            </text>
        </set>
        <set lineCount="12">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="4167" endLineNumber="4183"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="4110" endLineNumber="4126"/>
            <text>
                <![CDATA[
        'SET UP AND LAUNCH THE SLGCCA APPLICATION.  THIS IS DONE USING 
        'SHARED WEB STATE SO FILE CABINET MUST USE IT'S INSTANCE ID AND PUT THE DOCUMENT'S
        'SLGCCA DOCUMENTS ID WEBSTATE FOR SLGCCA DOCUMENT AND CALL THE SLGCCA DOCUMENT READ 
        'PAGE BY PASSING THE INSTANCE ID AS A QUERY STRING 

        Dim ex As Exception
        If _InstanceID = "" Then
            Try
                _InstanceID = Request.QueryString("InstanceID")
            Catch T As System.Threading.ThreadAbortException
            Catch ex
                Exit Sub
            End Try
        End If

        Dim ws As New WebState
                ]]>
            </text>
        </set>
        <set lineCount="12">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="487" endLineNumber="501"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="176" endLineNumber="190"/>
            <text>
                <![CDATA[
            Dim strErr As String = Nothing            Try
                Dim mq As MQ.IMQHelper
                mq = New Travelers.Claim.Data.MQ.MQHelper()
                Dim req(0) As String
                Dim ret() As String = Nothing

                Dim rec1 As coHostRecordHelper.coHostRecord

                Dim cohostLayout As New XmlDocument()
                Dim drvLtr As String = appSettings("Drive")
                Dim stLayoutPath As String = appSettings("Host_Record")

                Try
                    cohostLayout.Load(drvLtr.ToString() & stLayoutPath.ToString())
                ]]>
            </text>
        </set>
        <set lineCount="12">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="1946" endLineNumber="1962"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="1818" endLineNumber="1835"/>
            <text>
                <![CDATA[
        reqXMLNode = xmlReqDoc.SelectSingleNode("request/hdrsubverb")
        If reqXMLNode Is Nothing Then
            ' QC Defect ID:733  Modified By: MKANNAN3 Modified Date: 09/25/2009
            lblErrorMessage.Style.Add("display", "inline")
            lblErrorMessage.Text = "Unable to complete request.  Please try again then call FOSS if unsuccesful"

            Return String.Empty
            Exit Function
        End If

        'SET THE VALUE OF THE HDRSUBVERB NODE AND UPDATE IT TO BE FILECAB
        Try
            reqXMLNode.InnerXml = "FILECAB "
        Catch reqExcpt As Exception
            _ExcptInd = True
            ' QC Defect ID:733  Modified By: MKANNAN3 Modified Date: 09/25/2009
            lblErrorMessage.Style.Add("display", "inline")
                ]]>
            </text>
        </set>
        <set lineCount="12">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="3335" endLineNumber="3348"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="323" endLineNumber="336"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="531" endLineNumber="545"/>
            <text>
                <![CDATA[
            End If
        End If

        If stToDt = "" Then
            SetCalendarToDate()
        Else
            uwgToDate.Value = stToDt
        End If

        If stFromDt = "" Then
            SetCalendarFromDate()
        Else
            uwgFromDate.Value = stFromDt
        End If
                ]]>
            </text>
        </set>
        <set lineCount="13">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="447" endLineNumber="463"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="484" endLineNumber="500"/>
            <text>
                <![CDATA[
        stFcabSave = stFcabSave.Trim()
        If stFcabSave = "" Then
            Exit Sub
        End If

        ' can make into xmltextdocument
        Dim SaveDoc As New XmlDocument
        Try
            SaveDoc.LoadXml(stFcabSave)
        Catch ex As Exception
            Exit Sub
        End Try

        Dim xmlEvalList As XmlNodeList = SaveDoc.SelectNodes("//FileCabSave")
        Dim saveNode As XmlNode
        saveNode = xmlEvalList.Item(0)
                ]]>
            </text>
        </set>
        <set lineCount="13">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="2943" endLineNumber="2956"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="2996" endLineNumber="3009"/>
            <text>
                <![CDATA[
                stb.Append("javascript:CP_LaunchNewWindow('http://claimplatform.prodlb.travp.net/freeformdocuments2/DocOpen.aspx")
                'stb.Append("?FILE_ID=" & e.Row.Cells.FromKey("createdatetime").Value.ToString.Trim() & "&ENDOFQUERYSTRING=0" & "','','');")
                Dim delimiterStr As String = "_"
                Dim delimiter As Char() = delimiterStr.ToCharArray()
                Dim aryStr() As String = e.Row.Cells.FromKey("createdatetime").Value.ToString.Split(delimiter)
                Dim fileId As String = String.Empty
                If aryStr.Length >= 5 Then
                    fileId = aryStr(4)
                Else
                    fileId = e.Row.Cells.FromKey("createdatetime").Value.ToString
                End If

                stb.Append("?FILE_ID=" & fileId & "&InstanceID=" & _InstanceID & "&ENDOFQUERYSTRING=0" & "','','');")
                ]]>
            </text>
        </set>
        <set lineCount="13">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\Resend.aspx.vb" startLineNumber="813" endLineNumber="825"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\ViewUpdate.aspx.vb" startLineNumber="119" endLineNumber="133"/>
            <text>
                <![CDATA[
            Exit Function        End Try
        If Not stream = "" Then
            stream = stream.Trim()
        End If

        'check error in host return string
        If Not stream = "" Then
            Dim xmlFcabReq As New System.Xml.XmlDocument
            xmlFcabReq.LoadXml(stream)
            Dim errorText As String = ""
            Dim ErrOccurred As Boolean = ErrCheck(xmlFcabReq, errorText)
            If ErrOccurred Then
                lblErrorMessage.Text = errorText.ToString()
                lblErrorMessage.Visible = True
                ]]>
            </text>
        </set>
        <set lineCount="13">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="390" endLineNumber="405"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="474" endLineNumber="489"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="1276" endLineNumber="1291"/>
            <text>
                <![CDATA[
            End If            'GET THE VALUE OF THE HDRSUBVERB NODE AND UPDATE IT TO BE FILECAB
            Try
                reqXMLNode.InnerXml = _Function.ToString()
            Catch ex
                ExceptionManager.Publish(ex)
                stRetRecs = stRetRecs + CreateErrorXML(1, "Invalid Request Record")
                Return stRetRecs
            End Try

            Dim reqNodeList As XmlNodeList = xmlInput.SelectSingleNode("request").ChildNodes()

            Dim retVal As Long
            Dim strErr As String = Nothing
            Try
                Dim mq As MQ.IMQHelper
                ]]>
            </text>
        </set>
        <set lineCount="13">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\Resend.aspx.vb" startLineNumber="848" endLineNumber="864"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\WCDocOpen.aspx.vb" startLineNumber="149" endLineNumber="164"/>
            <text>
                <![CDATA[
        stUserId = Page.User.Identity.Name.Substring(Page.User.Identity.Name.IndexOf("\") + 1)        If Not stUserId = "" Then
            stUserId = stUserId.ToUpper()
        Else
            stUserId = "gcheng"
        End If
        Dim request As String = BuildRequestXMLString(stReqRecId, stUserId, "request")

        'process the request to meet our new requirement
        request = ModifyRequestXMLString(request)

        Dim stream As String = ""
        Dim FcabWS As New TravelersFileCabinetWebService.TravelersFileCabinetWebService
        FcabWS.Url = appSettings("TravelersFileCabinet.TravelersFileCabinetWebService.TravelersFileCabinetWebService")
        FcabWS.PreAuthenticate = True
        FcabWS.Credentials = [Global].myNetworkCache
                ]]>
            </text>
        </set>
        <set lineCount="13">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="322" endLineNumber="336"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="3334" endLineNumber="3348"/>
            <text>
                <![CDATA[
                        stFromDt = saveNode.SelectSingleNode("txtFromDate").InnerText                    End If
                End If
            End If
        End If

        If stToDt = "" Then
            SetCalendarToDate()
        Else
            uwgToDate.Value = stToDt
        End If

        If stFromDt = "" Then
            SetCalendarFromDate()
        Else
                ]]>
            </text>
        </set>
        <set lineCount="14">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="1159" endLineNumber="1176"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="1034" endLineNumber="1052"/>
            <text>
                <![CDATA[
                Dim ret() As String = Nothing                retVal = oClmMqHelper.SendReceive(APP, TRAN & "_" & appSettings("Host_Series"), req, ret, strErr)


                If Not retVal = 0 Then
                    stRet = stRet + CreateErrorXML(1, strErr.ToString())
                    Return stRet
                Else
                    Return stRet
                End If

            Catch ex
                ExceptionManager.Publish(ex)
                'Throw New BaseApplicationException(ex.ToString & " : " & "Base exception from FileCabinet DataObject PhotowebChangeReq")
                stRet = stRet + CreateErrorXML(1, ex.ToString())
                Return stRet
            End Try

            Return stRet
                ]]>
            </text>
        </set>
        <set lineCount="14">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="1308" endLineNumber="1325"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="506" endLineNumber="523"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="589" endLineNumber="606"/>
            <text>
                <![CDATA[
                    stRetRecs = stRetRecs + CreateErrorXML(1, ex.ToString())                    Return stRetRecs
                End Try

                req(0) = rec1.GetRecordValue()
                retVal = mq.SendReceive(APP, TRAN & "_" & appSettings("Host_Series"), req, ret, strErr)

                If retVal <> 0 Then
                    stRetRecs = stRetRecs + CreateErrorXML(retVal, strErr)
                    'stRetRecs = stRetRecs + GetComputerInfo()
                    Return stRetRecs
                End If

                If retVal = 0 Then
                    stRetRecs = getRetRecords(ret, cohostLayout)
                End If
            Catch ex
                ExceptionManager.Publish(ex)
                ]]>
            </text>
        </set>
        <set lineCount="14">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\SLGCCAOPEN.aspx.vb" startLineNumber="31" endLineNumber="49"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\DocOpenStart.aspx.vb" startLineNumber="32" endLineNumber="50"/>
            <text>
                <![CDATA[
    Friend Function verifyData(ByVal theForm As System.Collections.Specialized.NameValueCollection, ByVal theCookies As System.Web.HttpCookieCollection, ByVal theQueryString As System.Collections.Specialized.NameValueCollection) As Boolean
        Dim myCSSUtil As New Travelers.Enterprise.Util.CSScriptUtil()
        Dim myStringToCheck As New StringBuilder()
        Dim ele As Object
        For Each ele In theForm                'Iterate through each element.
            If Microsoft.VisualBasic.Left(ele.ToString, 2) <> "__" Then  'Bypass system elements (__viewstate, __EVENTTARGET, __EVENTSOURCE)
                myStringToCheck.Append(theForm(ele.ToString).ToString)
            End If
        Next
        'Add the cookies and querystring to the string to be checked.
        myStringToCheck.Append(theCookies)
        myStringToCheck.Append(theQueryString)
        verifyData = myCSSUtil.isSuspiciousPatternsFound(myStringToCheck.ToString)

    End Function

    Private Sub Page_PreInit(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.PreInit
        DisablePortalMenus = True
                ]]>
            </text>
        </set>
        <set lineCount="15">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="2066" endLineNumber="2084"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\RecipList.aspx.vb" startLineNumber="243" endLineNumber="261"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\ViewUpdate.aspx.vb" startLineNumber="193" endLineNumber="211"/>
            <text>
                <![CDATA[
        End If
        objRoot = objDom.CreateElement("datafields")
        objDom.AppendChild(objRoot)

        element = objDom.CreateElement("authorafotyp")
        elementTxt = objDom.CreateTextNode(_clmBlkafoType.ToString())
        objRoot.AppendChild(element)
        element.AppendChild(elementTxt)

        element = objDom.CreateElement("authorafo")
        elementTxt = objDom.CreateTextNode(_clmBlkuserAfo.ToString())
        objRoot.AppendChild(element)
        element.AppendChild(elementTxt)

        element = objDom.CreateElement("authorname")
        elementTxt = objDom.CreateTextNode("")
        objRoot.AppendChild(element)
        element.AppendChild(elementTxt)
                ]]>
            </text>
        </set>
        <set lineCount="15">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\RecipList.aspx.vb" startLineNumber="275" endLineNumber="293"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\ViewUpdate.aspx.vb" startLineNumber="225" endLineNumber="245"/>
            <text>
                <![CDATA[
        objRoot.AppendChild(element)        element.AppendChild(elementTxt)

        element = objDom.CreateElement("subfolder")
        elementTxt = objDom.CreateTextNode("")
        objRoot.AppendChild(element)
        element.AppendChild(elementTxt)

        element = objDom.CreateElement("repositoryname")
        elementTxt = objDom.CreateTextNode("")
        objRoot.AppendChild(element)
        element.AppendChild(elementTxt)

        element = objDom.CreateElement("repositorykey")
        elementTxt = objDom.CreateTextNode("")
        objRoot.AppendChild(element)
        element.AppendChild(elementTxt)

        'criteriacode field will be used to hold different keyword such as SDOC A or SDOC 9
        'these keyword will be decided later together with Bill
        element = objDom.CreateElement("criteriacode")
                ]]>
            </text>
        </set>
        <set lineCount="16">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\ViewUpdate.aspx.vb" startLineNumber="251" endLineNumber="271"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\RecipList.aspx.vb" startLineNumber="295" endLineNumber="315"/>
            <text>
                <![CDATA[
        objRoot.AppendChild(element)        element.AppendChild(elementTxt)

        element = objDom.CreateElement("formid")
        elementTxt = objDom.CreateTextNode(formid)
        objRoot.AppendChild(element)
        element.AppendChild(elementTxt)

        element = objDom.CreateElement("datetimestamp")
        elementTxt = objDom.CreateTextNode(datetimestamp)
        objRoot.AppendChild(element)
        element.AppendChild(elementTxt)

        element = objDom.CreateElement("formeffctivedate")
        elementTxt = objDom.CreateTextNode(formeffdate)
        objRoot.AppendChild(element)
        element.AppendChild(elementTxt)

        stRetrun = objDom.InnerXml.ToString()

        Return stRetrun
                ]]>
            </text>
        </set>
        <set lineCount="16">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\Resend.aspx.vb" startLineNumber="898" endLineNumber="918"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\WCDocOpen.aspx.vb" startLineNumber="183" endLineNumber="203"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\RecipList.aspx.vb" startLineNumber="207" endLineNumber="227"/>
            <text>
                <![CDATA[
    Private Function ModifyRequestXMLString(ByVal sRequest As String) As String        Dim xmlReqDoc As New XmlDocument
        xmlReqDoc.LoadXml(sRequest)

        Dim stRetReq As String = addReqRecordFields()

        Dim dtlXML As New XmlDocument
        dtlXML.LoadXml(stRetReq)

        Dim stHdrNode As String = xmlReqDoc.SelectSingleNode("request").InnerXml
        Dim stDtlNode As String = dtlXML.SelectSingleNode("datafields").InnerXml
        Dim stActualRequest As String = "<request>" & stHdrNode.ToString() & stDtlNode.ToString() & "</request>"

        Return stActualRequest
    End Function
    Private Function addReqRecordFields() As String
        Dim stRetrun As String = ""
        Dim objRoot As XmlElement
        Dim objDom As New XmlDocument
        Dim element As XmlElement
        Dim elementTxt As XmlText
                ]]>
            </text>
        </set>
        <set lineCount="17">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="1091" endLineNumber="1112"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="1372" endLineNumber="1393"/>
            <text>
                <![CDATA[
                rec1.SetXml(reqNodeList)
                req(0) = rec1.GetRecordValue()
                retVal = mq.SendReceive(APP, TRAN & "_" & appSettings("Host_Series"), req, ret, strErr)

                If retVal <> 0 Then
                    stRetRecs = stRetRecs + CreateErrorXML(retVal, strErr)
                    'stRetRecs = stRetRecs + GetComputerInfo()
                    Return stRetRecs
                End If

                If retVal = 0 Then
                    stRetRecs = getRetRecords(ret, cohostLayout)
                End If
            Catch ex
                ExceptionManager.Publish(ex)
                Throw New BaseApplicationException(retVal.ToString & " : " & "Base exception from FileCabinet DataObject GetRecords")
                stRetRecs = stRetRecs + CreateErrorXML(1, ex.ToString())
                Return stRetRecs
            End Try

            Return stRetRecs
                ]]>
            </text>
        </set>
        <set lineCount="17">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="229" endLineNumber="250"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="649" endLineNumber="670"/>
            <text>
                <![CDATA[
            Catch ex                ExceptionManager.Publish(ex)
                Return False
            End Try

            Try
                Dim oClmMqHelper As MQ.IMQHelper
                oClmMqHelper = New Travelers.Claim.Data.MQ.MQHelper()

                Dim req(0) As String

                Dim msg_id As String = Nothing
                Dim strErr As String = Nothing
                Dim cohostLayout As New XmlDocument()
                Dim drvLtr As String = appSettings("Drive")
                Dim stLayoutPath As String = appSettings("Host_Record")

                Try
                    cohostLayout.Load(drvLtr.ToString() & stLayoutPath.ToString())
                    Dim rec1 As coHostRecordHelper.coHostRecord

                    Try
                ]]>
            </text>
        </set>
        <set lineCount="17">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5682" endLineNumber="5698"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="6090" endLineNumber="6106"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5263" endLineNumber="5279"/>
            <text>
                <![CDATA[
                        strCCAWip.Append("<FORMNUM>")                        strCCAWip.Append(formid) 'formid
                        strCCAWip.Append("</FORMNUM>")
                        strCCAWip.Append("<LOB>WC</LOB>")
                        strCCAWip.Append("<APPSERVER>")
                        strCCAWip.Append("") 'application server if not empty
                        strCCAWip.Append("</APPSERVER>")
                        strCCAWip.Append("<LOGAFO>")
                        strCCAWip.Append(_clmBlkafoType + _clmBlkuserAfo)
                        strCCAWip.Append("</LOGAFO>")
                        strCCAWip.Append("<AUTHPERSID>")
                        strCCAWip.Append(authorPersID)
                        strCCAWip.Append("</AUTHPERSID>")
                        strCCAWip.Append("<SUBJ>")
                        strCCAWip.Append(ChangeSpacetoPlus(currnode.SelectSingleNode("subject").InnerText))
                        strCCAWip.Append("</SUBJ>")
                        strCCAWip.Append("<PRINTER>")
                ]]>
            </text>
        </set>
        <set lineCount="17">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="1838" endLineNumber="1859"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="1965" endLineNumber="1992"/>
            <text>
                <![CDATA[
            Return String.Empty            Exit Function
        End Try

        Dim stRetReq As String = addReqRecordFields()

        Dim dtlXML As New XmlDocument
        Try
            dtlXML.LoadXml(stRetReq)
        Catch

        End Try

        'NEED TO TAKE THE RETURNED REQUEST AND GET THE FOLDER SUB FOLDER ITEMS 
        'SEE WHAT THE REQUEST IS FROM THE DDLFOLDER AND DDLSUBFOLDER AND 
        'PUT THOSE VALUES INTO THE REQUEST 

        Dim stHdrNode As String = xmlReqDoc.SelectSingleNode("request").InnerXml
        Dim stDtlNode As String = dtlXML.SelectSingleNode("datafields").InnerXml

        Dim stActualRequest As String = "<request>" & stHdrNode.ToString() & stDtlNode.ToString() & "</request>"

        Try

            Dim FcabWS As New TravelersFileCabinetWebService.TravelersFileCabinetWebService
            FcabWS.Url = appSettings("TravelersFileCabinet.TravelersFileCabinetWebService.TravelersFileCabinetWebService")
            FcabWS.PreAuthenticate = True
            FcabWS.Credentials = [Global].myNetworkCache
                ]]>
            </text>
        </set>
        <set lineCount="19">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="2460" endLineNumber="2480"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="2500" endLineNumber="2521"/>
            <text>
                <![CDATA[
                    stTitle = objNode.SelectSingleNode("subject").InnerText
                    stTitle = stTitle.Trim()
                    If Not stTitle = "" Then
                        myArrTitle.SetValue(stTitle.ToString(), iTitle)
                        iTitle += 1
                    End If
                    stTitle = ""

                    stSender = objNode.SelectSingleNode("sendername").InnerText
                    stSender = stSender.Trim()
                    If Not stSender = "" Then
                        myArrSender.SetValue(stSender.ToString(), iSender)
                        iSender += 1
                    End If

                    stRecip = objNode.SelectSingleNode("FmtRecip").InnerText

                    stRecip = stRecip.Trim()
                    If Not stRecip = "" Then
                        myArrRecip.SetValue(stRecip.ToString(), iRecip)
                        iRecip += 1
                ]]>
            </text>
        </set>
        <set lineCount="19">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="254" endLineNumber="281"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="674" endLineNumber="701"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="1507" endLineNumber="1530"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="1446" endLineNumber="1469"/>
            <text>
                <![CDATA[
                    Catch ex                        ExceptionManager.Publish(ex)
                        Return False
                    End Try

                    retVal = oClmMqHelper.Send(APP, XTRAN & "_" & appSettings("Host_Series"), "D", msg_id, req, strErr)

                    If Not retVal = 0 Then
                        Return False
                    Else
                        Return True
                    End If

                Catch ex
                    ExceptionManager.Publish(ex)
                    Return False
                End Try

            Catch ex
                ExceptionManager.Publish(ex)
                Return False
            End Try

            Return False
                ]]>
            </text>
        </set>
        <set lineCount="19">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="103" endLineNumber="125"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="652" endLineNumber="675"/>
            <text>
                <![CDATA[
            End Try
            Try
                Dim oClmMqHelper As MQ.IMQHelper
                oClmMqHelper = New Travelers.Claim.Data.MQ.MQHelper()

                Dim req(0) As String

                Dim msg_id As String = Nothing
                Dim strErr As String = Nothing
                Dim cohostLayout As New XmlDocument()
                Dim drvLtr As String = appSettings("Drive")
                Dim stLayoutPath As String = appSettings("Host_Record")

                Try
                    cohostLayout.Load(drvLtr.ToString() & stLayoutPath.ToString())
                    Dim rec1 As coHostRecordHelper.coHostRecord

                    Try
                        rec1 = New coHostRecordHelper.coHostRecord(cohostLayout.SelectSingleNode("host-records/definitions/photowebchangereq"))
                        rec1.SetXml(oFCDataXmlNode.OuterXml.ToString)
                        req(0) = rec1.GetRecordValue()
                    Catch ex
                        ExceptionManager.Publish(ex)
                ]]>
            </text>
        </set>
        <set lineCount="19">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\RecipList.aspx.vb" startLineNumber="203" endLineNumber="227"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\WCDocOpen.aspx.vb" startLineNumber="179" endLineNumber="203"/>
            <text>
                <![CDATA[
            End If        End If
        Return stream
    End Function
    Private Function ModifyRequestXMLString(ByVal sRequest As String) As String
        Dim xmlReqDoc As New XmlDocument
        xmlReqDoc.LoadXml(sRequest)

        Dim stRetReq As String = addReqRecordFields()

        Dim dtlXML As New XmlDocument
        dtlXML.LoadXml(stRetReq)

        Dim stHdrNode As String = xmlReqDoc.SelectSingleNode("request").InnerXml
        Dim stDtlNode As String = dtlXML.SelectSingleNode("datafields").InnerXml
        Dim stActualRequest As String = "<request>" & stHdrNode.ToString() & stDtlNode.ToString() & "</request>"

        Return stActualRequest
    End Function
    Private Function addReqRecordFields() As String
        Dim stRetrun As String = ""
        Dim objRoot As XmlElement
        Dim objDom As New XmlDocument
        Dim element As XmlElement
        Dim elementTxt As XmlText
                ]]>
            </text>
        </set>
        <set lineCount="19">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="317" endLineNumber="339"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="397" endLineNumber="420"/>
            <text>
                <![CDATA[
                Return stRetRecs            End Try

            Dim reqNodeList As XmlNodeList = xmlInput.SelectSingleNode("request").ChildNodes()

            Dim retVal As Long
            Dim strErr As String = Nothing
            Try
                Dim mq As MQ.IMQHelper
                Dim req(0) As String
                Dim ret() As String = Nothing

                Dim rec1 As coHostRecordHelper.coHostRecord

                Dim cohostLayout As New XmlDocument()
                Dim drvLtr As String = appSettings("Drive")
                Dim stLayoutPath As String = appSettings("Host_Record")

                Try
                    cohostLayout.Load(drvLtr.ToString() & stLayoutPath.ToString())
                    rec1 = New coHostRecordHelper.coHostRecord(cohostLayout.SelectSingleNode("hostrecords/definitions/request"))
                    rec1.SetXml(reqNodeList)
                Catch ex
                    ExceptionManager.Publish(ex)
                ]]>
            </text>
        </set>
        <set lineCount="20">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="253" endLineNumber="281"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="1506" endLineNumber="1530"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="673" endLineNumber="701"/>
            <text>
                <![CDATA[
                        req(0) = rec1.GetRecordValue()                    Catch ex
                        ExceptionManager.Publish(ex)
                        Return False
                    End Try

                    retVal = oClmMqHelper.Send(APP, XTRAN & "_" & appSettings("Host_Series"), "D", msg_id, req, strErr)

                    If Not retVal = 0 Then
                        Return False
                    Else
                        Return True
                    End If

                Catch ex
                    ExceptionManager.Publish(ex)
                    'Throw New BaseApplicationException(ex.ToString & " : " & "Base exception from FileCabinet DataObject PhotowebChangeReq")
                    'stRetRecs = stRetRecs + GetComputerInfo()
                    Return False
                End Try

            Catch ex
                ExceptionManager.Publish(ex)
                'Throw New BaseApplicationException(ex.ToString & " : " & "Base exception from FileCabinet DataObject PhotowebChangeReq")
                'stRetRecs = stRetRecs + GetComputerInfo()
                Return False
            End Try

            Return False
                ]]>
            </text>
        </set>
        <set lineCount="21">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="503" endLineNumber="528"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="1305" endLineNumber="1330"/>
            <text>
                <![CDATA[
                    rec1.SetXml(reqNodeList)                Catch ex
                    ExceptionManager.Publish(ex)
                    stRetRecs = stRetRecs + CreateErrorXML(1, ex.ToString())
                    Return stRetRecs
                End Try

                req(0) = rec1.GetRecordValue()
                retVal = mq.SendReceive(APP, TRAN & "_" & appSettings("Host_Series"), req, ret, strErr)

                If retVal <> 0 Then
                    stRetRecs = stRetRecs + CreateErrorXML(retVal, strErr)
                    'stRetRecs = stRetRecs + GetComputerInfo()
                    Return stRetRecs
                End If

                If retVal = 0 Then
                    stRetRecs = getRetRecords(ret, cohostLayout)
                End If
            Catch ex
                ExceptionManager.Publish(ex)
                Throw New BaseApplicationException(retVal.ToString & " : " & "Base exception from FileCabinet DataObject GetRecords")
                stRetRecs = stRetRecs + CreateErrorXML(1, ex.ToString())
                'stRetRecs = stRetRecs + GetComputerInfo()
                Return stRetRecs
            End Try
                ]]>
            </text>
        </set>
        <set lineCount="23">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5658" endLineNumber="5680"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="6065" endLineNumber="6087"/>
            <text>
                <![CDATA[
                    Dim strCCAWip As New StringBuilder("")
                    strCCAWip.Append("<SERVICE NAME=""WIP"">")
                    strCCAWip.Append("<WIPKEYS><LIBRARY NAME=""TMATE"" CONFIG=""TRAVELERS""/>")
                    strCCAWip.Append("<KEY1 NAME=""KEY1"">")
                    strCCAWip.Append(_clmBlkBenfitState) 'benefit state
                    strCCAWip.Append("</KEY1>")
                    strCCAWip.Append("<KEYID NAME=""KEYID"">")
                    strCCAWip.Append(_clmBlknumber) 'caseid
                    strCCAWip.Append("</KEYID>")
                    strCCAWip.Append("<DATE_TIME NAME=""DATE_TIME"">")
                    strCCAWip.Append(getWIPdatetime(datetimestamp)) 'datetimestamp
                    strCCAWip.Append("</DATE_TIME>")
                    strCCAWip.Append("<STATUSCODE NAME=""STATUSCODE"">W</STATUSCODE>")
                    strCCAWip.Append("</WIPKEYS>")
                    strCCAWip.Append("<REQUESTDATA><CLAIMNUM>")
                    strCCAWip.Append(_clmBlknumber) 'claim number
                    strCCAWip.Append("</CLAIMNUM>")
                    strCCAWip.Append("<CMTNUM>001</CMTNUM>")
                    strCCAWip.Append("<MRLKEY1>")
                    strCCAWip.Append(_clmBlkBenfitState)
                    strCCAWip.Append("</MRLKEY1>")
                    strCCAWip.Append("<MRLKEY2>")
                ]]>
            </text>
        </set>
        <set lineCount="25">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\RecipList.aspx.vb" startLineNumber="242" endLineNumber="273"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\ViewUpdate.aspx.vb" startLineNumber="185" endLineNumber="223"/>
            <text>
                <![CDATA[
            _clmBlkafoType = ws.GetState("claimblock", "afo-type")
            'ToDO(Code)
            '_clmBlknumber = "DTE9489"
            '_cmtBlkNumber = ws.GetState("claimant", "number")
            '_clmBlkafoType = "A"
            '_clmBlkuserAfo = "130"
            'ToDO(Code) completed
        End If

        objRoot = objDom.CreateElement("datafields")
        objDom.AppendChild(objRoot)

        element = objDom.CreateElement("authorafotyp")
        elementTxt = objDom.CreateTextNode(_clmBlkafoType.ToString())
        objRoot.AppendChild(element)
        element.AppendChild(elementTxt)

        element = objDom.CreateElement("authorafo")
        elementTxt = objDom.CreateTextNode(_clmBlkuserAfo.ToString())
        objRoot.AppendChild(element)
        element.AppendChild(elementTxt)

        element = objDom.CreateElement("authorname")
        elementTxt = objDom.CreateTextNode("")
        objRoot.AppendChild(element)
        element.AppendChild(elementTxt)

        element = objDom.CreateElement("createfromdt")
        elementTxt = objDom.CreateTextNode("")
        objRoot.AppendChild(element)
        element.AppendChild(elementTxt)

        element = objDom.CreateElement("createtodt")
        elementTxt = objDom.CreateTextNode("")
        objRoot.AppendChild(element)
        element.AppendChild(elementTxt)

        element = objDom.CreateElement("folder")
                ]]>
            </text>
        </set>
        <set lineCount="26">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\filepath.vb" startLineNumber="130" endLineNumber="158"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\filepath.vb" startLineNumber="58" endLineNumber="86"/>
            <text>
                <![CDATA[
        mailMessage.Body = "<![CDATA[" & mailMessage.Body & "]]>"
        xmlEle = xmlDoc.CreateElement("strBody")
        xmlEle.InnerXml = mailMessage.Body '"<Para>Requestor Name: phu truong</Para><Para>Street Address: 123 nll</Para>"
        xmlRootMessage.AppendChild(xmlEle)

        Dim GotFileAttacth As Boolean = buildattatchment(filepath)

        Dim emailObj As New EmailFaxWebSrvc.EmailFaxWS 'cboEmailWrapper 'EmailFaxWebSrvc.EmailFaxWS
        emailObj.Url = AppSettings("TravelersFileCabinet.EmailFaxWebSrvc.EmailFaxWS")
        emailObj.PreAuthenticate = True
        emailObj.Credentials = [Global].myNetworkCache
        If GotFileAttacth Then
            Dim strReturn As String = emailObj.SendMultiEmailFax(xmlDoc.OuterXml, "freeform", True)
            If strReturn = "Message sent successfully." Then
                Dim RequestDoc As String
                RequestDoc = ConvertFormToXML()
                Dim NoteObj As New ClaimNotesWebService.ClaimNotesWebService
                NoteObj.Url = appSettings("Travelers.Claim.ClaimNotes.UI.ClaimNotesWebService.ClaimNotesWebService")
                NoteObj.PreAuthenticate = True
                NoteObj.Credentials = [Global].myNetworkCache
                Dim add_response As String
                add_response = NoteObj.sndAddUpdateData(RequestDoc)
            End If
        End If
        xmlDoc = Nothing
        emailObj = Nothing
        [Global].gFileSupport = ""
        resetemailstate()
                ]]>
            </text>
        </set>
        <set lineCount="26">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="1339" endLineNumber="1370"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="1058" endLineNumber="1089"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="942" endLineNumber="977"/>
            <text>
                <![CDATA[
            Dim stRetRecs As String = Nothing            Dim ex As Exception
            Dim xmlInput As New XmlDocument

            xmlInput.LoadXml(xmlRequest)

            _Function = SearchForFcabRecs.ToString()
            Dim reqXMLNode As XmlNode

            reqXMLNode = xmlInput.SelectSingleNode("request/hdractivity") 'hdractivity

            If reqXMLNode Is Nothing Then
                stRetRecs = stRetRecs + CreateErrorXML(1, "Invalid Request Record")
                Return stRetRecs
                Exit Function
            End If

            reqXMLNode.InnerXml = _Function.ToString()

            Dim reqNodeList As XmlNodeList = xmlInput.SelectSingleNode("request").ChildNodes()

            Dim retVal As Long
            Dim strErr As String = Nothing
            Try
                Dim mq As MQ.IMQHelper
                mq = New Travelers.Claim.Data.MQ.MQHelper
                Dim req(0) As String
                Dim ret() As String = Nothing

                Dim rec1 As coHostRecordHelper.coHostRecord

                Dim cohostLayout As New XmlDocument
                Dim drvLtr As String = appSettings("Drive")
                Dim stLayoutPath As String = appSettings("Host_Record")

                cohostLayout.Load(drvLtr.ToString() & stLayoutPath.ToString())
                ]]>
            </text>
        </set>
        <set lineCount="27">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="1057" endLineNumber="1089"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="1338" endLineNumber="1370"/>
            <text>
                <![CDATA[
            _Function = SearchForFcabRecs.ToString()            Dim stRetRecs As String = Nothing
            Dim ex As Exception
            Dim xmlInput As New XmlDocument

            xmlInput.LoadXml(xmlRequest)
            _Function = SearchForFcabRecs.ToString()
            Dim reqXMLNode As XmlNode
            reqXMLNode = xmlInput.SelectSingleNode("request/hdractivity") 'hdractivity
            If reqXMLNode Is Nothing Then
                stRetRecs = stRetRecs + CreateErrorXML(1, "Invalid Request Record")
                Return stRetRecs
                Exit Function
            End If
            reqXMLNode.InnerXml = _Function.ToString()

            Dim reqNodeList As XmlNodeList = xmlInput.SelectSingleNode("request").ChildNodes()

            Dim retVal As Long
            Dim strErr As String = Nothing
            Try
                Dim mq As MQ.IMQHelper
                mq = New Travelers.Claim.Data.MQ.MQHelper
                Dim req(0) As String
                Dim ret() As String = Nothing

                Dim rec1 As coHostRecordHelper.coHostRecord

                Dim cohostLayout As New XmlDocument
                Dim drvLtr As String = appSettings("Drive")
                Dim stLayoutPath As String = appSettings("Host_Record")

                cohostLayout.Load(drvLtr.ToString() & stLayoutPath.ToString())
                ]]>
            </text>
        </set>
        <set lineCount="27">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="457" endLineNumber="489"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="1259" endLineNumber="1291"/>
            <text>
                <![CDATA[
            Try                xmlInput.LoadXml(xmlRequest)
            Catch ex
                ExceptionManager.Publish(ex)
                stRetRecs = stRetRecs + CreateErrorXML(1, "Invalid Request Record")
                Return stRetRecs
            End Try

            _Function = SearchForFcabRecs.ToString()
            Dim reqXMLNode As XmlNode

            reqXMLNode = xmlInput.SelectSingleNode("request/hdractivity") 'hdractivity

            If reqXMLNode Is Nothing Then
                stRetRecs = stRetRecs + CreateErrorXML(1, "Invalid Request Record")
                Return stRetRecs
                Exit Function
            End If
            'GET THE VALUE OF THE HDRSUBVERB NODE AND UPDATE IT TO BE FILECAB
            Try
                reqXMLNode.InnerXml = _Function.ToString()
            Catch ex
                ExceptionManager.Publish(ex)
                stRetRecs = stRetRecs + CreateErrorXML(1, "Invalid Request Record")
                Return stRetRecs
            End Try

            Dim reqNodeList As XmlNodeList = xmlInput.SelectSingleNode("request").ChildNodes()

            Dim retVal As Long
            Dim strErr As String = Nothing
            Try
                Dim mq As MQ.IMQHelper
                ]]>
            </text>
        </set>
        <set lineCount="28">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="1496" endLineNumber="1530"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\WS\source\DataObjects\TravelersFileCabinetDO.vb" startLineNumber="663" endLineNumber="701"/>
            <text>
                <![CDATA[
                Dim drvLtr As String = appSettings("Drive")                Dim stLayoutPath As String = appSettings("Host_Record")

                Try
                    cohostLayout.Load(drvLtr.ToString() & stLayoutPath.ToString())
                    Dim rec1 As coHostRecordHelper.coHostRecord

                    Try
                        rec1 = New coHostRecordHelper.coHostRecord(cohostLayout.SelectSingleNode("host-records/definitions/photowebchangereq"))
                        rec1.SetXml(oFCDataXmlNode.OuterXml.ToString)
                        req(0) = rec1.GetRecordValue()
                    Catch ex
                        ExceptionManager.Publish(ex)
                        Return False
                    End Try

                    retVal = oClmMqHelper.Send(APP, XTRAN & "_" & appSettings("Host_Series"), "D", msg_id, req, strErr)

                    If Not retVal = 0 Then
                        Return False
                    Else
                        Return True
                    End If

                Catch ex
                    ExceptionManager.Publish(ex)
                    'Throw New BaseApplicationException(ex.ToString & " : " & "Base exception from FileCabinet DataObject PhotowebChangeReq")
                    'stRetRecs = stRetRecs + GetComputerInfo()
                    Return False
                End Try

            Catch ex
                ExceptionManager.Publish(ex)
                'Throw New BaseApplicationException(ex.ToString & " : " & "Base exception from FileCabinet DataObject PhotowebChangeReq")
                'stRetRecs = stRetRecs + GetComputerInfo()
                Return False
            End Try

            Return False
                ]]>
            </text>
        </set>
        <set lineCount="41">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5659" endLineNumber="5699"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5240" endLineNumber="5280"/>
            <text>
                <![CDATA[
                        Dim strCCAWip As New StringBuilder("")                        strCCAWip.Append("<SERVICE NAME=""DELETEWIP"">")
                        strCCAWip.Append("<WIPKEYS><LIBRARY NAME=""TMATE"" CONFIG=""TRAVELERS""/>")
                        strCCAWip.Append("<KEY1 NAME=""KEY1"">")
                        strCCAWip.Append(_clmBlkBenfitState) 'benefit state
                        strCCAWip.Append("</KEY1>")
                        strCCAWip.Append("<KEYID NAME=""KEYID"">")
                        strCCAWip.Append(_clmBlknumber) 'caseid
                        strCCAWip.Append("</KEYID>")
                        strCCAWip.Append("<DATE_TIME NAME=""DATE_TIME"">")
                        strCCAWip.Append(getWIPdatetime(datetimestamp)) 'datetimestamp
                        strCCAWip.Append("</DATE_TIME>")
                        strCCAWip.Append("<STATUSCODE NAME=""STATUSCODE"">W</STATUSCODE>")
                        strCCAWip.Append("</WIPKEYS>")
                        strCCAWip.Append("<REQUESTDATA><CLAIMNUM>")
                        strCCAWip.Append(_clmBlknumber) 'claim number
                        strCCAWip.Append("</CLAIMNUM>")
                        strCCAWip.Append("<CMTNUM>001</CMTNUM>")
                        strCCAWip.Append("<MRLKEY1>")
                        strCCAWip.Append(_clmBlkBenfitState)
                        strCCAWip.Append("</MRLKEY1>")
                        strCCAWip.Append("<MRLKEY2>")
                        strCCAWip.Append("</MRLKEY2>")
                        strCCAWip.Append("<FORMNUM>")
                        strCCAWip.Append(formid) 'formid
                        strCCAWip.Append("</FORMNUM>")
                        strCCAWip.Append("<LOB>WC</LOB>")
                        strCCAWip.Append("<APPSERVER>")
                        strCCAWip.Append("") 'application server if not empty
                        strCCAWip.Append("</APPSERVER>")
                        strCCAWip.Append("<LOGAFO>")
                        strCCAWip.Append(_clmBlkafoType + _clmBlkuserAfo)
                        strCCAWip.Append("</LOGAFO>")
                        strCCAWip.Append("<AUTHPERSID>")
                        strCCAWip.Append(authorPersID)
                        strCCAWip.Append("</AUTHPERSID>")
                        strCCAWip.Append("<SUBJ>")
                        strCCAWip.Append(ChangeSpacetoPlus(currnode.SelectSingleNode("subject").InnerText))
                        strCCAWip.Append("</SUBJ>")
                        strCCAWip.Append("<PRINTER>")
                        strCCAWip.Append("")
                ]]>
            </text>
        </set>
        <set lineCount="42">
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\ViewUpdate.aspx.vb" startLineNumber="695" endLineNumber="740"/>
            <block sourceFile="D:\HudsonWorkingDirectorySlave4\workspace\FileCabinet_Prj2\UI\source\TravelersFileCabinet.aspx.vb" startLineNumber="5415" endLineNumber="5461"/>
            <text>
                <![CDATA[
            node.SelectSingleNode("source").InnerText = FormateSource(node)            node.SelectSingleNode("status").InnerText = FormateStatus(node)
        Next

        Return xmldom.InnerXml.ToString
    End Function

    Private Function FormateDate(ByVal strDate As String) As String
        Dim strnewdate As String
        strDate = strDate.Trim
        If strDate.Length >= 8 Then
            If strDate.Length = 8 Then
                strnewdate = strDate.Substring(4, 2)
                strnewdate += "/"
                strnewdate += strDate.Substring(6, 2)
                strnewdate += "/"
                strnewdate += strDate.Substring(0, 4)
                Return strnewdate
            ElseIf strDate.Length = 10 Then
                strnewdate = strDate.Substring(5, 2)
                strnewdate += "/"
                strnewdate += strDate.Substring(8, 2)
                strnewdate += "/"
                strnewdate += strDate.Substring(0, 4)
                Return strnewdate
            End If
        Else
            Return strDate  'can't formate, just return the raw data
        End If

        Return String.Empty
    End Function
    Private Function FormateSource(ByRef node As XmlNode) As String
        Dim strFormid As String = node.SelectSingleNode("formid").InnerText
        Dim strSource As String = node.SelectSingleNode("source").InnerText
        Dim strInOut As String = node.SelectSingleNode("inoutind").InnerText
        If strInOut = "O" Then
            If strFormid.IndexOf("CA49") = 0 Or strFormid.IndexOf("C148") = 0 Then  'for outgoing EDI document only
                Return ConvertMediaCode(strSource)
            Else
                Return ConvertGenerateFromCode(strSource)
            End If
        ElseIf strInOut = "I" Then
            If strFormid = "C25220" Then
                Return "TTrak"
            End If
            If strFormid = "ISOFORMID" Then
                ]]>
            </text>
        </set>
        <summary duplicateFileCount="13" duplicateLineCount="2796" duplicateBlockCount="264" totalFileCount="20" totalRawLineCount="12698" totalSignificantLineCount="9245" processingTime="5047"/>
    </check>
</simian>
