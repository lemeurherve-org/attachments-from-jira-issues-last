<?xml version='1.0' encoding='UTF-8'?>
<project>
  <actions/>
  <description></description>
  <logRotator class="hudson.tasks.LogRotator">
    <daysToKeep>360</daysToKeep>
    <numToKeep>400</numToKeep>
    <artifactDaysToKeep>-1</artifactDaysToKeep>
    <artifactNumToKeep>-1</artifactNumToKeep>
  </logRotator>
  <keepDependencies>false</keepDependencies>
  <properties>
    <hudson.queueSorter.PrioritySorterJobProperty plugin="PrioritySorter@1.3">
      <priority>200</priority>
    </hudson.queueSorter.PrioritySorterJobProperty>
    <hudson.model.ParametersDefinitionProperty>
      <parameterDefinitions>
        <hudson.model.ChoiceParameterDefinition>
          <name>materialize_type</name>
          <description></description>
          <choices class="java.util.Arrays$ArrayList">
            <a class="string-array">
              <string>Update - use existing workspace, update repositories (if no workspace, do a new materialize)</string>
              <string>Fresh - discard any existing workspace, do a new materialize</string>
              <string>Redo - use existing workspace, rerun materialize (if no workspace, do a new materialize)</string>
              <string>Skip - use existing workspace unchanged</string>
            </a>
          </choices>
        </hudson.model.ChoiceParameterDefinition>
        <hudson.model.ChoiceParameterDefinition>
          <name>workspace_build_type</name>
          <description></description>
          <choices class="java.util.Arrays$ArrayList">
            <a class="string-array">
              <string>Incremental Build (only compile what has changed)</string>
              <string>Clean then Build (first discard any existing build)</string>
              <string>Skip Build step</string>
            </a>
          </choices>
        </hudson.model.ChoiceParameterDefinition>
      </parameterDefinitions>
    </hudson.model.ParametersDefinitionProperty>
    <hudson.plugins.throttleconcurrents.ThrottleJobProperty plugin="throttle-concurrents@1.7.2">
      <maxConcurrentPerNode>0</maxConcurrentPerNode>
      <maxConcurrentTotal>0</maxConcurrentTotal>
      <throttleEnabled>false</throttleEnabled>
      <throttleOption>project</throttleOption>
    </hudson.plugins.throttleconcurrents.ThrottleJobProperty>
  </properties>
  <scm class="hudson.plugins.git.GitSCM" plugin="git@1.4.0">
    <configVersion>2</configVersion>
    <userRemoteConfigs>
      <hudson.plugins.git.UserRemoteConfig>
        <name>origin</name>
        <refspec></refspec>
        <url>ssh://dascgitolite@dasc-git.diamond.ac.uk/diamond/diamond-testing.git</url>
      </hudson.plugins.git.UserRemoteConfig>
    </userRemoteConfigs>
    <branches>
      <hudson.plugins.git.BranchSpec>
        <name>master</name>
      </hudson.plugins.git.BranchSpec>
    </branches>
    <disableSubmodules>false</disableSubmodules>
    <recursiveSubmodules>false</recursiveSubmodules>
    <doGenerateSubmoduleConfigurations>false</doGenerateSubmoduleConfigurations>
    <authorOrCommitter>false</authorOrCommitter>
    <clean>true</clean>
    <wipeOutWorkspace>false</wipeOutWorkspace>
    <pruneBranches>false</pruneBranches>
    <remotePoll>false</remotePoll>
    <ignoreNotifyCommit>true</ignoreNotifyCommit>
    <useShallowClone>true</useShallowClone>
    <buildChooser class="hudson.plugins.git.util.DefaultBuildChooser"/>
    <gitTool>Default</gitTool>
    <submoduleCfg class="list"/>
    <relativeTargetDir>diamond-testing.git</relativeTargetDir>
    <reference></reference>
    <excludedRegions></excludedRegions>
    <excludedUsers></excludedUsers>
    <gitConfigName></gitConfigName>
    <gitConfigEmail></gitConfigEmail>
    <skipTag>true</skipTag>
    <includedRegions></includedRegions>
    <scmName></scmName>
  </scm>
  <quietPeriod>60</quietPeriod>
  <assignedNode>GDA-master-builds</assignedNode>
  <canRoam>false</canRoam>
  <disabled>false</disabled>
  <blockBuildWhenDownstreamBuilding>false</blockBuildWhenDownstreamBuilding>
  <blockBuildWhenUpstreamBuilding>false</blockBuildWhenUpstreamBuilding>
  <triggers>
    <hudson.triggers.TimerTrigger>
      <spec># build every 2 hours during the day (weekdays)
H 10-19/2 * * 1-5</spec>
    </hudson.triggers.TimerTrigger>
  </triggers>
  <concurrentBuild>false</concurrentBuild>
  <builders>
    <EnvInjectBuilder plugin="envinject@1.87">
      <info>
        <propertiesFilePath>diamond-testing.git/jenkins.control/properties/Common-environment-variables.properties</propertiesFilePath>
      </info>
    </EnvInjectBuilder>
    <EnvInjectBuilder plugin="envinject@1.87">
      <info>
        <propertiesFilePath>diamond-testing.git/jenkins.control/properties/GDA-master-environment-variables.properties</propertiesFilePath>
        <propertiesContent>keyring_location=default
materialize_component=uk.ac.gda.test.feature</propertiesContent>
      </info>
    </EnvInjectBuilder>
    <hudson.tasks.Shell>
      <command>. ${WORKSPACE}/diamond-testing.git/jenkins.control/job.scripts/set-execution-environment.sh

# source functions that we will use
. ${WORKSPACE}/diamond-testing.git/jenkins.control/job.scripts/materialize_function.sh
. ${WORKSPACE}/diamond-testing.git/jenkins.control/job.scripts/build_function.sh
. ${WORKSPACE}/diamond-testing.git/jenkins.control/job.scripts/junit_function.sh

materialize_function
build_function

cd ${materialize_workspace_path}
for dir in builder; do
    if [[ -d &quot;${dir}&quot; ]]; then
        svn revert -R &quot;${dir}&quot;
        svn update &quot;${dir}&quot;
    else
        svn checkout https://svn.diamond.ac.uk/subversion/gda/trunk/${dir} ${dir}
    fi
done
cd ${WORKSPACE}
for dir in thirdparty/eclipse; do
    if [[ -d &quot;${dir}&quot; ]]; then
        svn revert -R &quot;${dir}&quot;
        svn update &quot;${dir}&quot;
    else
        svn checkout https://svn.diamond.ac.uk/subversion/gda/${dir} ${dir}
    fi
done
cd -

junit_function
</command>
    </hudson.tasks.Shell>
  </builders>
  <publishers>
    <hudson.plugins.descriptionsetter.DescriptionSetterPublisher plugin="description-setter@1.8">
      <regexp>\*\*\*[^*]+ materialize_type=([A-Za-z]+) \*\*\*</regexp>
      <regexpForFailed>\*\*\*[^*]+ materialize_type=([A-Za-z]+) \*\*\*</regexpForFailed>
      <description>materialize_type=\1</description>
      <descriptionForFailed>materialize_type=\1</descriptionForFailed>
      <setForMatrix>false</setForMatrix>
    </hudson.plugins.descriptionsetter.DescriptionSetterPublisher>
    <com.chikli.hudson.plugin.naginator.NaginatorPublisher plugin="naginator@1.8">
      <regexpForRerun>.*(java\.net\.ConnectException: Connection refused|org\.tigris\.subversion\.javahl\.ClientException: svn: authentication cancelled|org\.eclipse\.jgit\.api\.errors\.JGitInternalException: Exception caught during execution of fetch command|java\.net\.SocketTimeoutException: Read timed out|java\.io\.IOException: Pipe closed).*</regexpForRerun>
      <rerunIfUnstable>false</rerunIfUnstable>
      <checkRegexp>true</checkRegexp>
      <delay class="com.chikli.hudson.plugin.naginator.FixedDelay">
        <delay>300</delay>
      </delay>
      <maxSchedule>2</maxSchedule>
    </com.chikli.hudson.plugin.naginator.NaginatorPublisher>
    <hudson.plugins.warnings.WarningsPublisher plugin="warnings@4.27">
      <healthy></healthy>
      <unHealthy></unHealthy>
      <thresholdLimit>low</thresholdLimit>
      <pluginName>[WARNINGS] </pluginName>
      <defaultEncoding></defaultEncoding>
      <canRunOnFailed>false</canRunOnFailed>
      <useStableBuildAsReference>false</useStableBuildAsReference>
      <useDeltaValues>false</useDeltaValues>
      <thresholds plugin="analysis-core@1.50">
        <unstableTotalAll></unstableTotalAll>
        <unstableTotalHigh></unstableTotalHigh>
        <unstableTotalNormal></unstableTotalNormal>
        <unstableTotalLow></unstableTotalLow>
        <failedTotalAll></failedTotalAll>
        <failedTotalHigh></failedTotalHigh>
        <failedTotalNormal></failedTotalNormal>
        <failedTotalLow></failedTotalLow>
      </thresholds>
      <shouldDetectModules>false</shouldDetectModules>
      <dontComputeNew>true</dontComputeNew>
      <doNotResolveRelativePaths>true</doNotResolveRelativePaths>
      <parserConfigurations/>
      <consoleParsers>
        <hudson.plugins.warnings.ConsoleParser>
          <parserName>Buckminster</parserName>
        </hudson.plugins.warnings.ConsoleParser>
      </consoleParsers>
    </hudson.plugins.warnings.WarningsPublisher>
    <hudson.plugins.tasks.TasksPublisher plugin="tasks@4.36">
      <healthy></healthy>
      <unHealthy></unHealthy>
      <thresholdLimit>low</thresholdLimit>
      <pluginName>[TASKS] </pluginName>
      <defaultEncoding></defaultEncoding>
      <canRunOnFailed>false</canRunOnFailed>
      <useStableBuildAsReference>false</useStableBuildAsReference>
      <useDeltaValues>false</useDeltaValues>
      <thresholds plugin="analysis-core@1.50">
        <unstableTotalAll></unstableTotalAll>
        <unstableTotalHigh></unstableTotalHigh>
        <unstableTotalNormal></unstableTotalNormal>
        <unstableTotalLow></unstableTotalLow>
        <failedTotalAll></failedTotalAll>
        <failedTotalHigh></failedTotalHigh>
        <failedTotalNormal></failedTotalNormal>
        <failedTotalLow></failedTotalLow>
      </thresholds>
      <shouldDetectModules>false</shouldDetectModules>
      <dontComputeNew>true</dontComputeNew>
      <doNotResolveRelativePaths>false</doNotResolveRelativePaths>
      <high>FIXME</high>
      <normal>TODO</normal>
      <low></low>
      <ignoreCase>false</ignoreCase>
      <pattern>materialize_workspace/plugins/**/*.java,materialize_workspace/plugins/**/*.py,materialize_workspace_git/gda-*/**/*.java,materialize_workspace_git/gda-*/**/*.py</pattern>
      <excludePattern>materialize_workspace/plugins/uk.ac.gda.libs/**</excludePattern>
    </hudson.plugins.tasks.TasksPublisher>
    <hudson.tasks.ArtifactArchiver>
      <artifacts>materialize_workspace/server_test_logs/**</artifacts>
      <latestOnly>false</latestOnly>
      <allowEmptyArchive>true</allowEmptyArchive>
    </hudson.tasks.ArtifactArchiver>
    <hudson.plugins.textfinder.TextFinderPublisher plugin="text-finder@1.9">
      <fileSet>materialize_workspace/post_build_status_marker.txt</fileSet>
      <regexp>MARK_BUILD_AS_UNSTABLE</regexp>
      <succeedIfFound>false</succeedIfFound>
      <unstableIfFound>true</unstableIfFound>
      <alsoCheckConsoleOutput>false</alsoCheckConsoleOutput>
    </hudson.plugins.textfinder.TextFinderPublisher>
    <hudson.tasks.junit.JUnitResultArchiver>
      <testResults>materialize_workspace/plugins/*/test-reports/TEST-*.xml,materialize_workspace_git/**/test-reports/TEST-*.xml,materialize_workspace/builder/test-reports/TEST-*.xml</testResults>
      <keepLongStdio>false</keepLongStdio>
      <testDataPublishers/>
    </hudson.tasks.junit.JUnitResultArchiver>
  </publishers>
  <buildWrappers>
    <hudson.plugins.build__timeout.BuildTimeoutWrapper plugin="build-timeout@1.11">
      <timeoutMinutes>90</timeoutMinutes>
      <failBuild>false</failBuild>
      <writingDescription>true</writingDescription>
      <timeoutPercentage>0</timeoutPercentage>
      <timeoutType>absolute</timeoutType>
      <timeoutMinutesElasticDefault>3</timeoutMinutesElasticDefault>
    </hudson.plugins.build__timeout.BuildTimeoutWrapper>
    <org.jvnet.hudson.plugins.exclusion.IdAllocator plugin="Exclusion@0.8">
      <ids>
        <org.jvnet.hudson.plugins.exclusion.DefaultIdType>
          <name>GDASERVERTEST</name>
        </org.jvnet.hudson.plugins.exclusion.DefaultIdType>
      </ids>
    </org.jvnet.hudson.plugins.exclusion.IdAllocator>
    <EnvInjectBuildWrapper plugin="envinject@1.87">
      <info>
        <scriptContent># [OPTIONAL] update the repo with yet-uncommitted changes
rsync --cvs-exclude --omit-dir-times --delete -irtv  /home/bmn54829/git/diamond-testing/ ${WORKSPACE}/diamond-testing.git/</scriptContent>
        <loadFilesFromMaster>false</loadFilesFromMaster>
      </info>
    </EnvInjectBuildWrapper>
  </buildWrappers>
</project>