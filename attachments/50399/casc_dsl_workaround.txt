# Use Configure block to put remote and browser URLs in place. Execute script via CasC:

jobs:
    - script: |
        pipelineJob('jenkins-seed') {
            blockOn('^.*$') {
                blockLevel('GLOBAL')
                scanQueueFor('ALL')
            }
            definition {
                cpsScm {
                    scm {
                        BbS {
                            branches {
                                branchSpec {
                                    name('refs/heads/master')
                                }
                            }
                            credentialsId('Build-User')
                            extensions {
                                cleanBeforeCheckout {
                                    deleteUntrackedNestedRepositories(true)
                                }
                                localBranch {
                                    localBranch('**')
                                }
                            }
                            gitTool(null)
                            id('jenkins-seed')
                            mirrorName('')
                            projectName('JENKINS')
                            repositoryName('jenkins-seed')
                            serverId('Bitbucket')
                        }
                    }
                }
            }
            quietPeriod(10)
            triggers {
                hudsonStartupTrigger {
                    label('master')
                    nodeParameterName(null)
                    quietPeriod('10')
                    runOnChoice(null)
                }
            }
            configure { node ->
                def gitScm = node / 'definition' / 'scm' / 'gitSCM'
                (gitScm / 'userRemoteConfigs' / 'hudson.plugins.git.UserRemoteConfig').appendNode('url', 'https://redacted.com/scm/jenkins/jenkins-seed.git')
                (gitScm / 'browser' / 'url').setValue('https://redacted.com/projects/JENKINS/repos/jenkins-seed')
            }
        }

# Resulting XML has remote and browser URLs:

<?xml version='1.1' encoding='UTF-8'?>
<flow-definition plugin="workflow-job@2.36">
  <actions>
    <org.jenkinsci.plugins.pipeline.modeldefinition.actions.DeclarativeJobAction plugin="pipeline-model-definition@1.5.1"/>
    <org.jenkinsci.plugins.pipeline.modeldefinition.actions.DeclarativeJobPropertyTrackerAction plugin="pipeline-model-definition@1.5.1">
      <jobProperties/>
      <triggers/>
      <parameters/>
      <options/>
    </org.jenkinsci.plugins.pipeline.modeldefinition.actions.DeclarativeJobPropertyTrackerAction>
  </actions>
  <description></description>
  <keepDependencies>false</keepDependencies>
  <properties>
    <hudson.plugins.buildblocker.BuildBlockerProperty plugin="build-blocker-plugin@1.7.3">
      <useBuildBlocker>true</useBuildBlocker>
      <blockLevel>GLOBAL</blockLevel>
      <scanQueueFor>ALL</scanQueueFor>
      <blockingJobs>^.*$</blockingJobs>
    </hudson.plugins.buildblocker.BuildBlockerProperty>
    <org.jenkinsci.plugins.workflow.job.properties.PipelineTriggersJobProperty>
      <triggers>
        <org.jvnet.hudson.plugins.triggers.startup.HudsonStartupTrigger plugin="startup-trigger-plugin@2.9.3">
          <spec></spec>
          <label>master</label>
          <quietPeriod>10</quietPeriod>
        </org.jvnet.hudson.plugins.triggers.startup.HudsonStartupTrigger>
      </triggers>
    </org.jenkinsci.plugins.workflow.job.properties.PipelineTriggersJobProperty>
  </properties>
  <definition class="org.jenkinsci.plugins.workflow.cps.CpsScmFlowDefinition" plugin="workflow-cps@2.80">
    <scm class="com.atlassian.bitbucket.jenkins.internal.scm.BitbucketSCM" plugin="atlassian-bitbucket-server-integration@1.0.4">
      <gitSCM plugin="git@4.1.1">
        <configVersion>2</configVersion>
        <userRemoteConfigs class="singleton-list">
          <hudson.plugins.git.UserRemoteConfig>
            <name>jenkins-seed</name>
            <url>https://redacted.com/scm/jenkins/jenkins-seed.git</url>
            <credentialsId>Build-User</credentialsId>
          </hudson.plugins.git.UserRemoteConfig>
        </userRemoteConfigs>
        <branches>
          <hudson.plugins.git.BranchSpec>
            <name>refs/heads/master</name>
          </hudson.plugins.git.BranchSpec>
        </branches>
        <doGenerateSubmoduleConfigurations>false</doGenerateSubmoduleConfigurations>
        <browser class="hudson.plugins.git.browser.Stash">
          <url>https://redacted.com/projects/JENKINS/repos/jenkins-seed</url>
        </browser>
        <submoduleCfg class="empty-list"/>
        <extensions>
          <hudson.plugins.git.extensions.impl.CleanBeforeCheckout>
            <deleteUntrackedNestedRepositories>true</deleteUntrackedNestedRepositories>
          </hudson.plugins.git.extensions.impl.CleanBeforeCheckout>
          <hudson.plugins.git.extensions.impl.LocalBranch>
            <localBranch>**</localBranch>
          </hudson.plugins.git.extensions.impl.LocalBranch>
          <com.atlassian.bitbucket.jenkins.internal.scm.BitbucketPostBuildStatus plugin="atlassian-bitbucket-server-integration@1.0.4">
            <jenkinsProvider class="com.atlassian.bitbucket.jenkins.internal.provider.DefaultJenkinsProvider"/>
            <serverId>Bitbucket</serverId>
          </com.atlassian.bitbucket.jenkins.internal.scm.BitbucketPostBuildStatus>
        </extensions>
      </gitSCM>
      <branches reference="../gitSCM/branches"/>
      <extensions>
        <hudson.plugins.git.extensions.impl.CleanBeforeCheckout reference="../../gitSCM/extensions/hudson.plugins.git.extensions.impl.CleanBeforeCheckout"/>
        <hudson.plugins.git.extensions.impl.LocalBranch reference="../../gitSCM/extensions/hudson.plugins.git.extensions.impl.LocalBranch"/>
        <com.atlassian.bitbucket.jenkins.internal.scm.BitbucketPostBuildStatus reference="../../gitSCM/extensions/com.atlassian.bitbucket.jenkins.internal.scm.BitbucketPostBuildStatus"/>
      </extensions>
      <id>jenkins-seed</id>
      <repositories>
        <com.atlassian.bitbucket.jenkins.internal.scm.BitbucketSCMRepository>
          <credentialsId>Build-User</credentialsId>
          <projectKey>JENKINS</projectKey>
          <projectName>JENKINS</projectName>
          <repositoryName>jenkins-seed</repositoryName>
          <repositorySlug>jenkins-seed</repositorySlug>
          <serverId>Bitbucket</serverId>
          <mirrorName></mirrorName>
        </com.atlassian.bitbucket.jenkins.internal.scm.BitbucketSCMRepository>
      </repositories>
      <isWebhookRegistered>false</isWebhookRegistered>
    </scm>
    <scriptPath>Jenkinsfile</scriptPath>
    <lightweight>false</lightweight>
  </definition>
  <quietPeriod>10</quietPeriod>
  <disabled>false</disabled>
</flow-definition>
